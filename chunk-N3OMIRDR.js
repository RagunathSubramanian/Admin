import{c as X,d as pe}from"./chunk-F3C3DPQ7.js";import{a as ne,b as De,c as oe,d as ge}from"./chunk-TPTFHVLD.js";import{a as re,b as me,c as ae,d as ce}from"./chunk-IH4XG7TN.js";import"./chunk-OCP6ILJ3.js";import{p as ee,r as ue}from"./chunk-OKMSR2WX.js";import"./chunk-DFADLG5I.js";import"./chunk-ZMABTEAI.js";import"./chunk-4QDCLFOO.js";import{c as te,d as de}from"./chunk-NI4BJD2M.js";import{$ as O,A as H,Ba as p,Bb as b,Cb as x,Db as I,K as le,Ka as M,Lb as h,Mb as R,Oa as P,Ob as A,T as k,Va as f,Wa as z,Xa as V,Yb as q,Zb as J,_a as E,_b as Q,aa as W,ab as j,bb as $,bc as U,cb as s,db as o,eb as S,fb as Y,ga as F,gb as G,hb as K,hc as B,ib as _,jb as T,oa as g,rb as d,sb as Z,tb as D}from"./chunk-VUHZN6IL.js";import{d as L}from"./chunk-3A3XYTID.js";function he(u,C){if(u&1){let e=K();s(0,"button",10),_("click",function(){let n=O(e).$implicit,a=T();return W(a.setRange(n.value))}),d(1),o()}if(u&2){let e=C.$implicit,t=T();V("bg-primary-600",t.performanceRange()===e.value)("text-white",t.performanceRange()===e.value)("border-primary-600",t.performanceRange()===e.value)("border-gray-200",t.performanceRange()!==e.value)("text-gray-600",t.performanceRange()!==e.value),p(),D(" ",e.label," ")}}function ye(u,C){if(u&1&&(Y(0),s(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",19),d(5),o(),s(6,"div")(7,"p",20),d(8),o(),s(9,"p",21),d(10),b(11,"date"),o()()()(),s(12,"div",22)(13,"div",23)(14,"p",24),d(15,"Drop Count"),o(),s(16,"p",25),d(17),b(18,"number"),o(),s(19,"p",26),d(20),b(21,"number"),o(),s(22,"p",26),d(23),b(24,"number"),o(),s(25,"p",26),d(26),b(27,"number"),o(),s(28,"p",26),d(29),b(30,"number"),o(),s(31,"p",26),d(32),b(33,"number"),o()(),s(34,"div",23)(35,"p",24),d(36,"Average / Day"),o(),s(37,"p",25),d(38),b(39,"number"),o(),s(40,"p",26),d(41),b(42,"number"),o()(),s(43,"div",23)(44,"p",24),d(45,"Multi Drops"),o(),s(46,"p",25),d(47),b(48,"number"),o()(),s(49,"div",23)(50,"p",24),d(51,"Heavy Drops"),o(),s(52,"p",25),d(53),b(54,"number"),o()()(),s(55,"div",27),S(56,"app-chart-wrapper",28)(57,"app-chart-wrapper",29),o(),S(58,"app-chart-wrapper",30),o(),G()),u&2){let e=C.ngIf,t=T(2);p(4),z("background-color",e.avatarColor),p(),D(" ",e.initials," "),p(3),Z(e.name),p(2),D(" First Record: ",e.hireDate?I(11,24,e.hireDate,"longDate"):"Unknown"," "),p(7),D(" ",x(18,27,e.totalDrops)," "),p(3),D(" Single drops: ",x(21,29,e.totalDrops-e.multiDrops-e.heavyDrops-e.doubleDrops)," "),p(3),D(" Multi drops: ",x(24,31,e.multiDrops)," "),p(3),D(" Heavy drops: ",x(27,33,e.heavyDrops)," "),p(3),D(" Walkup drops: ",x(30,35,e.walkupDrops)," "),p(3),D(" Double drops: ",x(33,37,e.doubleDrops)," "),p(6),D(" ",I(39,39,e.averageDropsPerDay,"1.0-1")," "),p(3),D(" Day Count : ",x(42,42,e.dailyTotals.size)," "),p(6),D(" ",x(48,44,e.multiDrops)," "),p(6),D(" ",x(54,46,e.heavyDrops)," "),p(3),f("chartData",t.employeeTrendChartData())("chartOptions",t.employeeTrendChartOptions)("chartType",t.lineChartType),p(),f("chartData",t.employeeDropTypeChartData())("chartOptions",t.employeeDropTypeChartOptions)("chartType",t.pieChartType),p(),f("chartData",t.employeeShiftChartData())("chartOptions",t.employeeShiftChartOptions)("chartType",t.barChartType)}}function Ce(u,C){if(u&1&&(s(0,"app-card",11),P(1,ye,59,48,"ng-container",12),o(),s(2,"section")(3,"app-card",13),S(4,"app-data-table",14),o()(),s(5,"section")(6,"app-card",15),S(7,"app-data-table",14),o()()),u&2){let e=T();p(),f("ngIf",e.selectedEmployee()),p(3),f("columns",e.groupedTableColumns)("data",e.groupedTableDataSignal)("pagination",!0)("pageSize",e.groupedTablePageSize)("showToolbar",!1)("showFilters",!0)("searchable",!1),p(3),f("columns",e.dropRecordsTableColumns)("data",e.dropRecordsTableDataSignal)("pagination",!0)("pageSize",e.dropRecordsTablePageSize)("showToolbar",!1)("showFilters",!0)("searchable",!1)}}function ve(u,C){u&1&&(s(0,"div",9),d(1," No performance data found for the selected range. "),o())}var be,ie,se=L(()=>{"use strict";A();B();ue();de();me();ce();pe();A();B();be=(u,C)=>C.value;ie=(()=>{class u{authService=k(X);avatarPalette=["#2563eb","#16a34a","#ea580c","#9333ea","#0ea5e9","#f97316","#dc2626","#14b8a6"];recordsSignal=g([]);tabledata=g([]);currentUserEmail=h(()=>this.authService.getCurrentUserEmail());set records(e){this.recordsSignal.set(Array.isArray(e)?e:[]),this.tabledata.set(this.filteredTableData()||[])}performanceRange=g("month");customStart=g(null);customEnd=g(null);selectedEmployeeId=g(null);rangeOptions=[{label:"Today",value:"today"},{label:"This Week",value:"week"},{label:"This Month",value:"month"},{label:"This Year",value:"year"}];filteredRecords=h(()=>{let e=this.recordsSignal(),t=this.performanceRange(),n=this.customStart(),a=this.customEnd(),i=this.currentUserEmail(),r=e;if(i){let m=i.toLowerCase().trim();r=e.filter(y=>{let w=(y["Email Address"]||"").toLowerCase().trim(),N=w===m;return!N&&e.length>0&&e.indexOf(y)===0&&console.log("User Performance Panel - Email mismatch:",{userEmail:m,recordEmail:w,record:y}),N}),console.log("User Performance Panel - Filtered records:",r.length,"out of",e.length)}else console.warn("User Performance Panel - No user email found, showing all records");let{startDate:l,endDate:c}=this.getRangeBounds(t,n,a);if(!l&&!c)return r;var v=r.filter(m=>{let y=this.parseRecordDate(m);return!(!y||l&&y<l||c&&y>c)});return v});employeeSummaries=h(()=>{let e=this.filteredRecords();if(!e.length)return[];let t=new Map;e.forEach(r=>{let l=r.FIN||r.NAME||`employee-${r.Timestamp}`,c=r.NAME?.trim()||"Unknown",v=this.getInitials(c),m=t.get(l)||{id:l,name:c,initials:v,totalDrops:0,hireDate:null,dailyTotals:new Map,dropTypes:{"Single Drops":0,"Multi Drops":0,"Heavy Drops":0,"Walkup Drop Count":0,"Double Drop Count":0},shifts:new Set,multiDrops:0,heavyDrops:0,walkupDrops:0,doubleDrops:0,records:[]},y=this.parseRecordDate(r);if(y){m.hireDate=this.getEarlierDate(m.hireDate,y);let w=this.formatDateKey(y),N=m.dailyTotals.get(w)??0;m.dailyTotals.set(w,N+this.ensureNumber(r.DropCount))}m.totalDrops+=this.ensureNumber(r.DropCount),m.multiDrops+=this.ensureNumber(r["Multi Drops"]),m.heavyDrops+=this.ensureNumber(r["Heavy Drops"]),m.walkupDrops+=this.ensureNumber(r["Walkup Drop Count"]),m.doubleDrops+=this.ensureNumber(r["Double Drop Count"]),m.dropTypes["Single Drops"]+=this.ensureNumber(r.DropCount-r["Multi Drops"]-r["Heavy Drops"]-r["Double Drop Count"]),m.dropTypes["Multi Drops"]+=this.ensureNumber(r["Multi Drops"]),m.dropTypes["Heavy Drops"]+=this.ensureNumber(r["Heavy Drops"]),m.dropTypes["Walkup Drop Count"]+=this.ensureNumber(r["Walkup Drop Count"]),m.dropTypes["Double Drop Count"]+=this.ensureNumber(r["Double Drop Count"]),r.Shift&&m.shifts.add(r.Shift),m.records.push(r),t.set(l,m)});let n=Array.from(t.values()),a=n.reduce((r,l)=>r+l.totalDrops,0),i=n.length?a/n.length:0;return n.map((r,l)=>{let c=r.dailyTotals.size||1,v=r.totalDrops/c,m=r.totalDrops>i?"up":r.totalDrops<i?"down":"flat";return{id:r.id,name:r.name,initials:r.initials,avatarColor:this.avatarPalette[l%this.avatarPalette.length],totalDrops:r.totalDrops,averageDropsPerDay:v,hireDate:r.hireDate,percentageOfTotal:a?r.totalDrops/a:0,trendDirection:m,dailyTotals:r.dailyTotals,dropTypes:r.dropTypes,shifts:Array.from(r.shifts),multiDrops:r.multiDrops,heavyDrops:r.heavyDrops,walkupDrops:r.walkupDrops,doubleDrops:r.doubleDrops,records:r.records}}).sort((r,l)=>l.totalDrops-r.totalDrops)});selectedEmployee=h(()=>{let e=this.selectedEmployeeId(),t=this.employeeSummaries();if(!t.length)return null;if(e){let n=t.find(a=>a.id===e);if(n)return n}return t[0]});employeeTrendChartData=h(()=>{let e=this.selectedEmployee();if(!e)return this.createLineChartData([],[],"Daily Drops",{background:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 1)"});let t=Array.from(e.dailyTotals.keys()).sort(),n=t.map(i=>this.formatDisplayDate(i)),a=t.map(i=>e.dailyTotals.get(i)??0);return this.createLineChartData(n,a,"Daily Drops",{background:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 1)"})});employeeTrendChartOptions={elements:{line:{tension:.4}},scales:{y:{beginAtZero:!0}},plugins:{legend:{display:!1}},responsive:!0,maintainAspectRatio:!1};employeeDropTypeChartData=h(()=>{let e=this.selectedEmployee();if(!e)return this.createPieChartData([],[]);let t=Object.entries(e.dropTypes).filter(([,n])=>this.ensureNumber(n)>0);return t.length?this.createPieChartData(t.map(([n])=>n),t.map(([,n])=>n),["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"]):this.createPieChartData([],[])});employeeDropTypeChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}};employeeShiftChartData=h(()=>{let e=this.selectedEmployee();if(!e)return this.createBarChartData([],[],"Drops by Shift");let t=this.groupAndSumByDropCount(e.records,n=>n.Shift||"Unassigned");return this.createBarChartData(t.labels,t.values,"Drops by Shift",{background:"rgba(22, 163, 74, 0.8)",border:"rgba(22, 163, 74, 1)"})});employeeShiftChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};isCustomRangeValid=h(()=>{let e=this.customStart(),t=this.customEnd();if(!e||!t)return!1;let n=new Date(e),a=new Date(t);return n.setHours(0,0,0,0),a.setHours(0,0,0,0),n<=a});lineChartType="line";pieChartType="pie";barChartType="bar";constructor(){R(()=>{let e=this.employeeSummaries(),t=this.selectedEmployeeId();if(!e.length){t!==null&&this.selectedEmployeeId.set(null);return}(t?e.some(a=>a.id===t):!1)||this.selectedEmployeeId.set(e[0].id)}),R(()=>{let e=this.groupedTableData();this.groupedTableDataSignal.set(e)}),R(()=>{let e=this.dropRecordsTableData();this.dropRecordsTableDataSignal.set(e)})}setRange(e){this.performanceRange.set(e),this.tabledata.set(this.filteredTableData()||[]),e!=="custom"&&(this.customStart.set(null),this.customEnd.set(null))}applyCustomRange(){this.isCustomRangeValid()&&this.performanceRange.set("custom")}updateCustomStart(e){this.customStart.set(e||null)}updateCustomEnd(e){this.customEnd.set(e||null)}selectEmployee(e){this.selectedEmployeeId.set(e),this.tabledata.set(this.filteredTableData()||[])}trackByEmployeeId(e,t){return t.id}getRangeBounds(e,t,n){let a=new Date,i=new Date(a.getFullYear(),a.getMonth(),a.getDate());switch(e){case"today":return{startDate:i,endDate:new Date(i.getTime()+24*60*60*1e3-1)};case"week":{let r=new Date(i);return r.setDate(r.getDate()-6),{startDate:r,endDate:a}}case"month":return{startDate:new Date(a.getFullYear(),a.getMonth(),1),endDate:a};case"year":return{startDate:new Date(a.getFullYear(),0,1),endDate:a};case"custom":{let r=t?new Date(new Date(t).setHours(0,0,0,0)):null,l=n?new Date(new Date(n).setHours(0,0,0,0)):null;return{startDate:r,endDate:l}}default:return{startDate:null,endDate:null}}}parseRecordDate(e){let t=e.DATE||e.Timestamp;if(!t)return null;let n=new Date(t);return Number.isNaN(n.getTime())?null:n}getInitials(e){let t=e.split(" ").filter(Boolean);return t.length===0?"?":t.length===1?t[0].slice(0,2).toUpperCase():(t[0][0]+t[t.length-1][0]).toUpperCase()}ensureNumber(e){if(typeof e=="number")return Number.isFinite(e)?e:0;let t=Number(e);return Number.isFinite(t)?t:0}getEarlierDate(e,t){return e?t<e?t:e:t}formatDateKey(e){let t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${a}`}formatDisplayDate(e){let t=e.split("-");if(t.length!==3)return e;let[n,a,i]=t,r=Number(n),l=Number(a),c=Number(i);return!r||!l||!c?e:new Date(r,l-1,c).toLocaleDateString(void 0,{month:"short",day:"numeric"})}createLineChartData(e,t,n,a){return{labels:e,datasets:[{data:t,label:n,backgroundColor:a.background,borderColor:a.border,pointBackgroundColor:a.border,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:a.border,fill:"origin"}]}}createBarChartData(e,t,n,a={background:"rgba(59, 130, 246, 0.8)",border:"rgba(59, 130, 246, 1)"}){return{labels:e,datasets:[{data:t,label:n,backgroundColor:a.background,borderColor:a.border,borderWidth:1}]}}createPieChartData(e,t,n=[]){return{labels:e,datasets:[{data:t,backgroundColor:n.length>0?n:["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"],borderColor:"#fff",borderWidth:1}]}}groupAndSum(e,t,n){let a=new Map;e.forEach(l=>{let c=t(l)||"Unknown",v=a.get(c)??0,m=this.ensureNumber(l[n]);a.set(c,v+m)});let i=Array.from(a.keys()),r=i.map(l=>a.get(l)??0);return{labels:i,values:r}}groupAndSumByDropCount(e,t){let n=new Map;e.forEach(r=>{let l=t(r)||"Unknown",v=(n.get(l)??0)+this.ensureNumber(r.DropCount);n.set(l,v)});let a=Array.from(n.keys()),i=a.map(r=>n.get(r)??0);return{labels:a,values:i}}getTrendIcon(e){switch(e){case"up":return"\u2191";case"down":return"\u2193";default:return"\u2192"}}getTrendClasses(e){switch(e){case"up":return"text-green-600";case"down":return"text-red-600";default:return"text-gray-500"}}filteredTableData=h(()=>this.selectedEmployee()?.records||[]);groupedTableData=h(()=>{let e=this.filteredTableData();if(!e.length)return[];let t=new Map;return e.forEach(a=>{let i=a.DATE||"Unknown",r=a.NAME||"Unknown",l=`${i}|${r}`,c=t.get(l);c?(c["Total Drops"]+=this.ensureNumber(a["Total Drops"]),c["Multi Drops"]+=this.ensureNumber(a["Multi Drops"]),c["Heavy Drops"]+=this.ensureNumber(a["Heavy Drops"]),c["Walkup Drop Count"]+=this.ensureNumber(a["Walkup Drop Count"]),c["Double Drop Count"]+=this.ensureNumber(a["Double Drop Count"]),c.DropCount+=this.ensureNumber(a.DropCount||0)):t.set(l,{DATE:i,NAME:r,"Total Drops":this.ensureNumber(a["Total Drops"]),"Multi Drops":this.ensureNumber(a["Multi Drops"]),"Heavy Drops":this.ensureNumber(a["Heavy Drops"]),"Walkup Drop Count":this.ensureNumber(a["Walkup Drop Count"]),"Double Drop Count":this.ensureNumber(a["Double Drop Count"]),DropCount:this.ensureNumber(a.DropCount||0)})}),Array.from(t.values()).sort((a,i)=>{let r=this.parseRecordDate({DATE:a.DATE}),l=this.parseRecordDate({DATE:i.DATE});return!r&&!l?0:r?l?l.getTime()-r.getTime():-1:1})});groupedTableDataSignal=g([]);groupedTablePageSize=g(10);dropRecordsTableData=h(()=>{let e=this.filteredTableData();return e.length?[...e].sort((t,n)=>{let a=this.parseRecordDate(t),i=this.parseRecordDate(n);return!a&&!i?0:a?i?i.getTime()-a.getTime():-1:1}):[]});dropRecordsTableDataSignal=g([]);dropRecordsTablePageSize=g(10);dropRecordsTableColumns=[{key:"DATE",label:"Date",sortable:!0,filterable:!0},{key:"NAME",label:"Name",sortable:!0,filterable:!0},{key:"Shift",label:"Shift",sortable:!0,filterable:!0},{key:"Total Drops",label:"Total Drops",sortable:!0,render:e=>this.ensureNumber(e["Total Drops"]).toLocaleString()},{key:"Multi Drops",label:"Multi Drops",sortable:!0,render:e=>this.ensureNumber(e["Multi Drops"]).toLocaleString()},{key:"Heavy Drops",label:"Heavy Drops",sortable:!0,render:e=>this.ensureNumber(e["Heavy Drops"]).toLocaleString()},{key:"Walkup Drop Count",label:"Walkup Drops",sortable:!0,render:e=>this.ensureNumber(e["Walkup Drop Count"]).toLocaleString()},{key:"Double Drop Count",label:"Double Drops",sortable:!0,render:e=>this.ensureNumber(e["Double Drop Count"]).toLocaleString()}];groupedTableColumns=[{key:"DATE",label:"Date",sortable:!0,filterable:!0},{key:"NAME",label:"Name",sortable:!0,filterable:!0},{key:"Total Drops",label:"Total Drops",sortable:!0,render:e=>e["Total Drops"].toLocaleString()},{key:"Multi Drops",label:"Multi Drops",sortable:!0,render:e=>e["Multi Drops"].toLocaleString()},{key:"Heavy Drops",label:"Heavy Drops",sortable:!0,render:e=>e["Heavy Drops"].toLocaleString()},{key:"Walkup Drop Count",label:"Walkup Drops",sortable:!0,render:e=>e["Walkup Drop Count"].toLocaleString()},{key:"Double Drop Count",label:"Double Drops",sortable:!0,render:e=>e["Double Drop Count"].toLocaleString()},{key:"DropCount",label:"Drop Count",sortable:!0,render:e=>e.DropCount.toLocaleString()}];static \u0275fac=function(t){return new(t||u)};static \u0275cmp=M({type:u,selectors:[["app-user-performance-panel"]],inputs:{records:"records"},decls:15,vars:4,consts:[[1,"space-y-6"],[1,"flex","flex-col","gap-3","lg:flex-row","lg:items-center","lg:justify-between"],[1,"flex","flex-wrap","gap-2"],["type","button",1,"rounded-full","border","px-4","py-1.5","text-sm","font-medium","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"bg-primary-600","text-white","border-primary-600","border-gray-200","text-gray-600"],[1,"flex","flex-wrap","items-center","gap-2"],["type","date",1,"rounded-md","border","border-gray-300","px-3","py-1.5","text-sm","focus:border-primary-500","focus:outline-none","focus:ring-2","focus:ring-primary-200",3,"change","value"],[1,"text-sm","text-gray-400"],["type","button",1,"rounded-md","bg-primary-600","px-4","py-1.5","text-sm","font-medium","text-white","transition","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","disabled:bg-gray-300","disabled:text-gray-500",3,"click","disabled"],[1,"space-y-4"],[1,"rounded-lg","border","border-dashed","border-gray-300","bg-gray-50","p-8","text-center","text-sm","text-gray-500"],["type","button",1,"rounded-full","border","px-4","py-1.5","text-sm","font-medium","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"click"],["title","My Performance Overview","padding","sm"],[4,"ngIf"],["title","Grouped Summary","subtitle","Grouped by Date and Name","padding","sm"],[3,"columns","data","pagination","pageSize","showToolbar","showFilters","searchable"],["title","Drop Records","subtitle","All records ordered by date (newest first)","padding","sm"],[1,"flex","flex-col","gap-4"],[1,"flex","flex-wrap","items-center","justify-between","gap-3"],[1,"flex","items-center","gap-3"],[1,"flex","h-12","w-12","items-center","justify-center","rounded-full","text-lg","font-semibold","text-white"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"grid","grid-cols-2","gap-4","md:grid-cols-4"],[1,"rounded-lg","border","border-gray-200","bg-gray-50","p-3"],[1,"text-xs","uppercase","text-gray-400"],[1,"mt-1","text-lg","font-semibold","text-gray-900"],[1,"mt-1","text-xs","text-gray-500"],[1,"grid","grid-cols-1","gap-4","lg:grid-cols-2"],["title","Daily Drops Trend","subtitle","Drops completed per day","height","240px",3,"chartData","chartOptions","chartType"],["title","Drop Distribution","subtitle","Mix of drop types","height","240px",3,"chartData","chartOptions","chartType"],["title","Drops by Shift","subtitle","Shift allocation","height","240px",3,"chartData","chartOptions","chartType"]],template:function(t,n){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),j(3,he,2,11,"button",3,be),o(),s(5,"div",4)(6,"input",5),_("change",function(i){return n.updateCustomStart((i.target==null?null:i.target.value)||"")}),o(),s(7,"span",6),d(8,"to"),o(),s(9,"input",5),_("change",function(i){return n.updateCustomEnd((i.target==null?null:i.target.value)||"")}),o(),s(10,"button",7),_("click",function(){return n.applyCustomRange()}),d(11," Apply "),o()()(),s(12,"div",8),P(13,Ce,8,15)(14,ve,2,0,"div",9),o()()),t&2&&(p(3),$(n.rangeOptions),p(3),f("value",n.customStart()||""),p(3),f("value",n.customEnd()||""),p(),f("disabled",!n.isCustomRangeValid()),p(3),E(n.selectedEmployee()?13:14))},dependencies:[U,q,Q,J,ee,te,re,ae],encapsulation:2})}return u})()});function xe(u,C){u&1&&(s(0,"div",3),d(1," Loading performance data\u2026 "),o())}function Te(u,C){if(u&1&&(s(0,"div",4),d(1),o()),u&2){let e=T();p(),D(" ",e.error()," ")}}function Se(u,C){if(u&1&&S(0,"app-user-performance-panel",5),u&2){let e=T();f("records",e.performanceData())}}var je,Ee=L(()=>{A();B();De();le();ge();se();A();je=(()=>{class u{dashboardService=k(oe);destroyRef=k(F);isLoading=g(!1);error=g(null);performanceData=g([]);ngOnInit(){this.loadPerformanceData()}loadPerformanceData(){this.isLoading.set(!0),this.error.set(null),this.dashboardService.getDashboardData().pipe(ne(this.destroyRef),H(()=>this.isLoading.set(!1))).subscribe({next:e=>{console.log("User Performance - Data loaded:",e.length,"records"),e.length>0&&(console.log("User Performance - Sample record email field:",e[0]["Email Address"]),console.log("User Performance - All unique emails in data:",[...new Set(e.map(t=>t["Email Address"]).filter(Boolean))])),this.performanceData.set(e)},error:e=>{this.error.set(this.extractErrorMessage(e)),this.performanceData.set([])}})}extractErrorMessage(e){return e instanceof Error||e&&typeof e=="object"&&"message"in e&&typeof e.message=="string"?e.message:"Unable to load performance data. Please try again later."}static \u0275fac=function(t){return new(t||u)};static \u0275cmp=M({type:u,selectors:[["app-user-performance"]],decls:9,vars:3,consts:[[1,"space-y-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"rounded-md","border","border-primary-200","bg-primary-50","px-4","py-3","text-sm","text-primary-800"],[1,"rounded-md","border","border-red-200","bg-red-50","px-4","py-3","text-sm","text-red-700"],[3,"records"]],template:function(t,n){t&1&&(s(0,"div",0)(1,"div")(2,"h1",1),d(3,"My Performance"),o(),s(4,"p",2),d(5," View your drops, trends, and performance metrics. "),o()(),P(6,xe,2,0,"div",3)(7,Te,2,1,"div",4)(8,Se,1,1,"app-user-performance-panel",5),o()),t&2&&(p(6),E(n.isLoading()?6:-1),p(),E(n.error()?7:-1),p(),E(!n.isLoading()&&!n.error()?8:-1))},dependencies:[U,ie],encapsulation:2})}return u})()});Ee();export{je as UserPerformanceComponent};
