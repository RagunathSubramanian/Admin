import{a as de,b as _e,c as fe,d as Ce}from"./chunk-3VHVEV36.js";import{a as ue,b as ve}from"./chunk-VKGD23XU.js";import"./chunk-OCP6ILJ3.js";import"./chunk-WQPEQQJO.js";import{o as me,q as xe}from"./chunk-ZNXBTVER.js";import{a as ce,b as De}from"./chunk-BWHYGX4V.js";import"./chunk-HPUSM2II.js";import{$ as _,$a as k,$b as se,A as G,Ab as x,Ba as s,Bb as L,Cb as P,Db as W,Eb as ne,K as he,Ka as A,Kb as D,Lb as ae,Nb as M,Oa as T,T as B,Ua as O,Va as h,Wa as H,Xa as $,Ya as K,Yb as ie,Za as Q,Zb as oe,_a as E,_b as le,aa as C,ab as w,ac as pe,bb as o,bc as V,cb as l,db as N,eb as X,fb as ee,ga as q,gb as I,hb as S,ib as f,ic as j,oa as b,pb as te,qb as p,rb as R,sb as y,tb as re}from"./chunk-77XPDUDI.js";import{a as z,b as J,d as Z}from"./chunk-3A3XYTID.js";function Ee(i,c){if(i&1){let e=I();o(0,"button",26),S("click",function(){let r=_(e).$implicit,n=f();return C(n.setRange(r.value))}),p(1),l()}if(i&2){let e=c.$implicit,t=f();$("bg-primary-600",t.performanceRange()===e.value)("text-white",t.performanceRange()===e.value)("border-primary-600",t.performanceRange()===e.value)("border-gray-200",t.performanceRange()!==e.value)("text-gray-600",t.performanceRange()!==e.value),s(),y(" ",e.label," ")}}function ke(i,c){i&1&&(o(0,"div",11),p(1," No employees found for the selected range. "),l())}function we(i,c){if(i&1){let e=I();o(0,"button",28),S("click",function(){let r=_(e).$implicit,n=f(2);return C(n.selectEmployee(r.id))}),o(1,"div",29)(2,"div",30),p(3),l(),o(4,"div",31)(5,"div",32)(6,"div")(7,"p",33),p(8),l(),o(9,"p",34),p(10),x(11,"date"),l()(),o(12,"div",35)(13,"p",36),p(14,"Total Drops"),l(),o(15,"p",37),p(16),x(17,"number"),l()()(),o(18,"div",38)(19,"div",39),p(20," Avg / Day: "),o(21,"span",40),p(22),x(23,"number"),l()(),o(24,"div",41)(25,"span"),p(26),l(),o(27,"span",39),p(28),x(29,"percent"),l()()()()()()}if(i&2){let e,t,r,n=c.$implicit,m=f(2);$("border-primary-500",((e=m.selectedEmployee())==null?null:e.id)===n.id)("bg-primary-50",((t=m.selectedEmployee())==null?null:t.id)===n.id)("border-gray-200",((r=m.selectedEmployee())==null?null:r.id)!==n.id),s(2),H("background-color",n.avatarColor),s(),y(" ",n.initials," "),s(5),R(n.name),s(2),y(" ",n.hireDate?P(11,17,n.hireDate,"mediumDate"):"Hire date unknown"," "),s(6),y(" ",L(17,20,n.totalDrops)," "),s(6),y(" ",P(23,22,n.averageDropsPerDay,"1.0-1")," "),s(3),K(m.getTrendClasses(n.trendDirection)),s(),y(" ",m.getTrendIcon(n.trendDirection)," "),s(2),y(" ",P(29,25,n.percentageOfTotal,"1.0-1")," ")}}function Pe(i,c){if(i&1&&k(0,we,30,28,"button",27,Q().trackByEmployeeId,!0),i&2){let e=f();w(e.employeeSummaries())}}function Ie(i,c){if(i&1&&(X(0),o(1,"div",14)(2,"div",15)(3,"div",44)(4,"div",30),p(5),l(),o(6,"div")(7,"p",45),p(8),l(),o(9,"p",46),p(10),x(11,"date"),l()()(),o(12,"div",35)(13,"p",36),p(14,"Contribution"),l(),o(15,"p",47),p(16),x(17,"percent"),l()()(),o(18,"div",48)(19,"div",49)(20,"p",50),p(21,"Total Drops"),l(),o(22,"p",51),p(23),x(24,"number"),l()(),o(25,"div",49)(26,"p",50),p(27,"Average / Day"),l(),o(28,"p",51),p(29),x(30,"number"),l()(),o(31,"div",49)(32,"p",50),p(33,"Amount"),l(),o(34,"p",51),p(35),x(36,"currency"),l()(),o(37,"div",49)(38,"p",50),p(39,"Average Amount / Day"),l(),o(40,"p",51),p(41),x(42,"currency"),l()()(),o(43,"div",52),N(44,"app-chart-wrapper",53)(45,"app-chart-wrapper",54),l(),N(46,"app-chart-wrapper",55),l(),ee()),i&2){let e=c.ngIf,t=f(2);s(4),H("background-color",e.avatarColor),s(),y(" ",e.initials," "),s(3),R(e.name),s(2),y(" Hired: ",e.hireDate?P(11,19,e.hireDate,"longDate"):"Unknown"," "),s(6),y(" ",P(17,22,e.percentageOfTotal,"1.0-1")," "),s(7),y(" ",L(24,25,e.totalDrops)," "),s(6),y(" ",P(30,27,e.averageDropsPerDay,"1.0-1")," "),s(6),y(" ",W(36,30,e.amount,"$ ","symbol","1.0-0")," "),s(6),y(" ",W(42,35,e.averageAmountPerDay,"$ ","symbol","1.0-0")," "),s(3),h("chartData",t.employeeTrendChartData())("chartOptions",t.employeeTrendChartOptions)("chartType",t.lineChartType),s(),h("chartData",t.employeeDropTypeChartData())("chartOptions",t.employeeDropTypeChartOptions)("chartType",t.pieChartType),s(),h("chartData",t.employeeShiftChartData())("chartOptions",t.employeeShiftChartOptions)("chartType",t.barChartType)}}function Fe(i,c){if(i&1&&(o(0,"app-card",42),T(1,Ie,47,40,"ng-container",43),l()),i&2){let e=f();s(),h("ngIf",e.selectedEmployee())}}function Ne(i,c){i&1&&p(0," \u2191 ")}function Ae(i,c){i&1&&p(0," \u2193 ")}function Re(i,c){i&1&&p(0," \u21C5 ")}function Me(i,c){if(i&1){let e=I();o(0,"th",21)(1,"button",56),S("click",function(){let r=_(e).$implicit,n=f();return C(n.toggleSort(r.key))}),o(2,"span"),p(3),l(),o(4,"span",57),T(5,Ne,1,0)(6,Ae,1,0)(7,Re,1,0),l()()()}if(i&2){let e=c.$implicit,t=f();s(3),R(e.label),s(2),E(t.getSortDirection(e.key)==="asc"?5:t.getSortDirection(e.key)==="desc"?6:7)}}function Ve(i,c){if(i&1){let e=I();o(0,"th",23)(1,"input",58),S("input",function(r){let n,m=_(e).$implicit,a=f();return C(a.updateFilter(m.key,(n=r.target==null?null:r.target.value)!==null&&n!==void 0?n:""))}),l()()}if(i&2){let e=c.$implicit,t=f();s(),h("value",t.getFilterValue(e.key))("placeholder","Filter "+e.label),O("type",e.type==="number"?"number":e.type==="date"?"date":"text")}}function Be(i,c){if(i&1&&(o(0,"td",59),p(1),l()),i&2){let e=c.$implicit,t=f().$implicit,r=f();s(),y(" ",r.formatCellValue(t,e)," ")}}function Oe(i,c){if(i&1&&(o(0,"tr",25),k(1,Be,2,1,"td",59,U),l()),i&2){let e=f();s(),w(e.tableColumns)}}function He(i,c){if(i&1&&(o(0,"tr")(1,"td",60),p(2," No records match the current filters. "),l()()),i&2){let e=f();s(),O("colspan",e.tableColumns.length)}}function $e(i,c){i&1&&(o(0,"div",61),p(1," Select an employee to view detailed performance charts. "),l())}var Te,U,ye,ge=Z(()=>{"use strict";M();j();xe();De();ve();M();j();Te=(i,c)=>c.value,U=(i,c)=>c.key;ye=(()=>{class i{avatarPalette=["#2563eb","#16a34a","#ea580c","#9333ea","#0ea5e9","#f97316","#dc2626","#14b8a6"];recordsSignal=b([]);tabledata=b([]);set records(e){this.recordsSignal.set(Array.isArray(e)?e:[]),this.tabledata.set(this.filteredTableData()||[])}performanceRange=b("month");customStart=b(null);customEnd=b(null);selectedEmployeeId=b(null);rangeOptions=[{label:"Today",value:"today"},{label:"This Week",value:"week"},{label:"This Month",value:"month"},{label:"This Year",value:"year"}];filteredRecords=D(()=>{let e=this.recordsSignal(),t=this.performanceRange(),r=this.customStart(),n=this.customEnd(),{startDate:m,endDate:a}=this.getRangeBounds(t,r,n);if(!m&&!a)return e;var d=e.filter(g=>{let v=this.parseRecordDate(g);return!(!v||m&&v<m||a&&v>a)});return d});employeeSummaries=D(()=>{let e=this.filteredRecords();if(!e.length)return[];let t=new Map;e.forEach(a=>{let d=a.FIN||a.NAME||`employee-${a.Timestamp}`,g=a.NAME?.trim()||"Unknown",v=this.getInitials(g),u=t.get(d)||{id:d,name:g,initials:v,totalDrops:0,hireDate:null,dailyTotals:new Map,dropTypes:{"Multi Drops":0,"Heavy Drops":0,"Walkup Drop Count":0,"Double Drop Count":0},shifts:new Set,amount:0,multiDrops:0,heavyDrops:0,walkupDrops:0,doubleDrops:0,records:[]},F=this.parseRecordDate(a);if(F){u.hireDate=this.getEarlierDate(u.hireDate,F);let Y=this.formatDateKey(F),be=u.dailyTotals.get(Y)??0;u.dailyTotals.set(Y,be+this.ensureNumber(a["Total Drops"]))}u.totalDrops+=this.ensureNumber(a["Total Drops"]),u.amount+=this.ensureNumber(a.Amount),u.multiDrops+=this.ensureNumber(a["Multi Drops"]),u.heavyDrops+=this.ensureNumber(a["Heavy Drops"]),u.walkupDrops+=this.ensureNumber(a["Walkup Drop Count"]),u.doubleDrops+=this.ensureNumber(a["Double Drop Count"]),u.dropTypes["Multi Drops"]+=this.ensureNumber(a["Multi Drops"]),u.dropTypes["Heavy Drops"]+=this.ensureNumber(a["Heavy Drops"]),u.dropTypes["Walkup Drop Count"]+=this.ensureNumber(a["Walkup Drop Count"]),u.dropTypes["Double Drop Count"]+=this.ensureNumber(a["Double Drop Count"]),a.Shift&&u.shifts.add(a.Shift),u.records.push(a),t.set(d,u)});let r=Array.from(t.values()),n=r.reduce((a,d)=>a+d.totalDrops,0),m=r.length?n/r.length:0;return r.map((a,d)=>{let g=a.dailyTotals.size||1,v=a.totalDrops/g,u=a.amount/g,F=a.totalDrops>m?"up":a.totalDrops<m?"down":"flat";return{id:a.id,name:a.name,initials:a.initials,avatarColor:this.avatarPalette[d%this.avatarPalette.length],totalDrops:a.totalDrops,averageDropsPerDay:v,averageAmountPerDay:u,hireDate:a.hireDate,percentageOfTotal:n?a.totalDrops/n:0,trendDirection:F,dailyTotals:a.dailyTotals,dropTypes:a.dropTypes,shifts:Array.from(a.shifts),amount:a.amount,multiDrops:a.multiDrops,heavyDrops:a.heavyDrops,walkupDrops:a.walkupDrops,doubleDrops:a.doubleDrops,records:a.records}}).sort((a,d)=>d.totalDrops-a.totalDrops)});selectedEmployee=D(()=>{let e=this.selectedEmployeeId(),t=this.employeeSummaries();if(!t.length)return null;if(e){let r=t.find(n=>n.id===e);if(r)return r}return t[0]});employeeTrendChartData=D(()=>{let e=this.selectedEmployee();if(!e)return this.createLineChartData([],[],"Daily Drops",{background:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 1)"});let t=Array.from(e.dailyTotals.keys()).sort(),r=t.map(m=>this.formatDisplayDate(m)),n=t.map(m=>e.dailyTotals.get(m)??0);return this.createLineChartData(r,n,"Daily Drops",{background:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 1)"})});employeeTrendChartOptions={elements:{line:{tension:.4}},scales:{y:{beginAtZero:!0}},plugins:{legend:{display:!1}},responsive:!0,maintainAspectRatio:!1};employeeDropTypeChartData=D(()=>{let e=this.selectedEmployee();if(!e)return this.createPieChartData([],[]);let t=Object.entries(e.dropTypes).filter(([,r])=>this.ensureNumber(r)>0);return t.length?this.createPieChartData(t.map(([r])=>r),t.map(([,r])=>r),["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"]):this.createPieChartData([],[])});employeeDropTypeChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}};employeeShiftChartData=D(()=>{let e=this.selectedEmployee();if(!e)return this.createBarChartData([],[],"Drops by Shift");let t=this.groupAndSum(e.records,r=>r.Shift||"Unassigned","Total Drops");return this.createBarChartData(t.labels,t.values,"Drops by Shift",{background:"rgba(22, 163, 74, 0.8)",border:"rgba(22, 163, 74, 1)"})});employeeShiftChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};isCustomRangeValid=D(()=>{let e=this.customStart(),t=this.customEnd();if(!e||!t)return!1;let r=new Date(e),n=new Date(t);return r.setHours(0,0,0,0),n.setHours(0,0,0,0),r<=n});lineChartType="line";pieChartType="pie";barChartType="bar";constructor(){ae(()=>{let e=this.employeeSummaries(),t=this.selectedEmployeeId();if(!e.length){t!==null&&this.selectedEmployeeId.set(null);return}(t?e.some(n=>n.id===t):!1)||this.selectedEmployeeId.set(e[0].id)})}setRange(e){this.performanceRange.set(e),this.tabledata.set(this.filteredTableData()||[]),e!=="custom"&&(this.customStart.set(null),this.customEnd.set(null))}applyCustomRange(){this.isCustomRangeValid()&&this.performanceRange.set("custom")}updateCustomStart(e){this.customStart.set(e||null),this.customStart.set(e||null)}updateCustomEnd(e){this.customEnd.set(e||null)}selectEmployee(e){this.selectedEmployeeId.set(e),this.tabledata.set(this.filteredTableData()||[])}trackByEmployeeId(e,t){return t.id}getRangeBounds(e,t,r){let n=new Date,m=new Date(n.getFullYear(),n.getMonth(),n.getDate());switch(e){case"today":return{startDate:m,endDate:new Date(m.getTime()+24*60*60*1e3-1)};case"week":{let a=new Date(m);return a.setDate(a.getDate()-6),{startDate:a,endDate:n}}case"month":return{startDate:new Date(n.getFullYear(),n.getMonth(),1),endDate:n};case"year":return{startDate:new Date(n.getFullYear(),0,1),endDate:n};case"custom":{let a=t?new Date(new Date(t).setHours(0,0,0,0)):null,d=r?new Date(new Date(r).setHours(0,0,0,0)):null;return{startDate:a,endDate:d}}default:return{startDate:null,endDate:null}}}parseRecordDate(e){let t=e.DATE||e.Timestamp;if(!t)return null;let r=new Date(t);return Number.isNaN(r.getTime())?null:r}getInitials(e){let t=e.split(" ").filter(Boolean);return t.length===0?"?":t.length===1?t[0].slice(0,2).toUpperCase():(t[0][0]+t[t.length-1][0]).toUpperCase()}ensureNumber(e){if(typeof e=="number")return Number.isFinite(e)?e:0;let t=Number(e);return Number.isFinite(t)?t:0}getEarlierDate(e,t){return e?t<e?t:e:t}formatDateKey(e){return e.toISOString().split("T")[0]}formatDisplayDate(e){let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}createLineChartData(e,t,r,n){return{labels:e,datasets:[{data:t,label:r,backgroundColor:n.background,borderColor:n.border,pointBackgroundColor:n.border,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:n.border,fill:"origin"}]}}createBarChartData(e,t,r,n={background:"rgba(59, 130, 246, 0.8)",border:"rgba(59, 130, 246, 1)"}){return{labels:e,datasets:[{data:t,label:r,backgroundColor:n.background,borderColor:n.border,borderWidth:1}]}}createPieChartData(e,t,r=[]){return{labels:e,datasets:[{data:t,backgroundColor:r.length>0?r:["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"],borderColor:"#fff",borderWidth:1}]}}groupAndSum(e,t,r){let n=new Map;e.forEach(d=>{let g=t(d)||"Unknown",v=n.get(g)??0,u=this.ensureNumber(d[r]);n.set(g,v+u)});let m=Array.from(n.keys()),a=m.map(d=>n.get(d)??0);return{labels:m,values:a}}getTrendIcon(e){switch(e){case"up":return"\u2191";case"down":return"\u2193";default:return"\u2192"}}getTrendClasses(e){switch(e){case"up":return"text-green-600";case"down":return"text-red-600";default:return"text-gray-500"}}recordsCount=D(()=>this.filteredRecords().length);tableColumns=[{key:"DATE",label:"Date",type:"text"},{key:"NAME",label:"Name",type:"text"},{key:"Shift",label:"Shift",type:"text"},{key:"Total Drops",label:"Total Drops",type:"number",numeric:!0},{key:"Multi Drops",label:"Multi Drops",type:"number",numeric:!0},{key:"Heavy Drops",label:"Heavy Drops",type:"number",numeric:!0},{key:"Walkup Drop Count",label:"Walkup Drops",type:"number",numeric:!0},{key:"Double Drop Count",label:"Double Drops",type:"number",numeric:!0},{key:"Amount",label:"Amount",type:"number",numeric:!0}];BydaytableColumns=[{key:"DATE",label:"Date",type:"text"},{key:"NAME",label:"Name",type:"text"},{key:"Total Drops",label:"Total Drops",type:"number",numeric:!0},{key:"Multi Drops",label:"Multi Drops",type:"number",numeric:!0},{key:"Heavy Drops",label:"Heavy Drops",type:"number",numeric:!0},{key:"Walkup Drop Count",label:"Walkup Drops",type:"number",numeric:!0},{key:"Double Drop Count",label:"Double Drops",type:"number",numeric:!0},{key:"Amount",label:"Amount",type:"number",numeric:!0}];tableFilters=b(this.tableColumns.reduce((e,t)=>(e[t.key]="",e),{}));sortState=b(null);filteredTableData=D(()=>this.selectedEmployee()?.records||[]);updateFilter(e,t){this.tableFilters.update(r=>J(z({},r),{[e]:t}))}clearFilters(){this.tableFilters.set(this.tableColumns.reduce((e,t)=>(e[t.key]="",e),{}))}toggleSort(e){this.sortState.update(t=>!t||t.key!==e?{key:e,direction:"asc"}:t.direction==="asc"?{key:e,direction:"desc"}:null)}getSortDirection(e){return this.sortState()?.key===e?this.sortState().direction:null}getFilterValue(e){return this.tableFilters()[e]??""}formatCellValue(e,t){let r=e[t.key];return r==null?"\u2014":t.key==="Amount"?new Intl.NumberFormat(void 0,{style:"currency",currency:"SGD",maximumFractionDigits:0}).format(this.ensureNumber(r)):t.key==="Timestamp"?this.formatTimestamp(String(r)):String(r)}trackByRecord=(e,t)=>t.Timestamp||t.FIN||e;formatTimestamp(e){if(!e)return"Unknown time";let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=A({type:i,selectors:[["app-performance-panel"]],inputs:{records:"records"},decls:40,vars:9,consts:[["noSelection",""],[1,"space-y-6"],[1,"flex","flex-col","gap-3","lg:flex-row","lg:items-center","lg:justify-between"],[1,"flex","flex-wrap","gap-2"],["type","button",1,"rounded-full","border","px-4","py-1.5","text-sm","font-medium","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"bg-primary-600","text-white","border-primary-600","border-gray-200","text-gray-600"],[1,"flex","flex-wrap","items-center","gap-2"],["type","date",1,"rounded-md","border","border-gray-300","px-3","py-1.5","text-sm","focus:border-primary-500","focus:outline-none","focus:ring-2","focus:ring-primary-200",3,"change","value"],[1,"text-sm","text-gray-400"],["type","button",1,"rounded-md","bg-primary-600","px-4","py-1.5","text-sm","font-medium","text-white","transition","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","disabled:bg-gray-300","disabled:text-gray-500",3,"click","disabled"],[1,"grid","grid-cols-1","gap-6","lg:grid-cols-[320px_minmax(0,1fr)]"],[1,"space-y-4"],[1,"rounded-lg","border","border-dashed","border-gray-300","bg-gray-50","p-6","text-center","text-sm","text-gray-500"],["title","Performance Overview","padding","sm",4,"ngIf","ngIfElse"],["title","Drop Records","subtitle","Filter each column or sort to analyse individual drop performance","padding","sm"],[1,"flex","flex-col","gap-4"],[1,"flex","flex-wrap","items-center","justify-between","gap-3"],[1,"text-sm","text-gray-600"],["type","button",1,"inline-flex","items-center","gap-2","rounded-md","border","border-gray-300","bg-white","px-3","py-1.5","text-sm","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"click"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],["scope","col",1,"px-4","py-3","text-left","text-xs","font-semibold","uppercase","tracking-wider","text-gray-500"],[1,"bg-white"],[1,"px-4","py-2"],[1,"bg-white","divide-y","divide-gray-200"],[1,"hover:bg-gray-50"],["type","button",1,"rounded-full","border","px-4","py-1.5","text-sm","font-medium","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"click"],["type","button",1,"w-full","rounded-xl","border","px-4","py-4","text-left","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"border-primary-500","bg-primary-50","border-gray-200"],["type","button",1,"w-full","rounded-xl","border","px-4","py-4","text-left","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"click"],[1,"flex","items-start","gap-4"],[1,"flex","h-12","w-12","items-center","justify-center","rounded-full","text-lg","font-semibold","text-white"],[1,"flex-1","space-y-2"],[1,"flex","items-center","justify-between","gap-2"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"text-right"],[1,"text-xs","text-gray-400"],[1,"text-sm","font-semibold","text-gray-900"],[1,"flex","items-center","justify-between","gap-2","text-xs"],[1,"text-gray-500"],[1,"font-medium","text-gray-900"],[1,"flex","items-center","gap-1"],["title","Performance Overview","padding","sm"],[4,"ngIf"],[1,"flex","items-center","gap-3"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"text-base","font-medium","text-gray-900"],[1,"grid","grid-cols-2","gap-4","md:grid-cols-4"],[1,"rounded-lg","border","border-gray-200","bg-gray-50","p-3"],[1,"text-xs","uppercase","text-gray-400"],[1,"mt-1","text-lg","font-semibold","text-gray-900"],[1,"grid","grid-cols-1","gap-4","lg:grid-cols-2"],["title","Daily Drops Trend","subtitle","Drops completed per day","height","240px",3,"chartData","chartOptions","chartType"],["title","Drop Distribution","subtitle","Mix of drop types","height","240px",3,"chartData","chartOptions","chartType"],["title","Drops by Shift","subtitle","Shift allocation for this team member","height","240px",3,"chartData","chartOptions","chartType"],["type","button",1,"flex","items-center","gap-2","text-left","hover:text-primary-600","focus:outline-none",3,"click"],[1,"text-gray-400"],[1,"w-full","rounded-md","border","border-gray-300","px-2","py-1","text-sm","focus:border-primary-500","focus:outline-none","focus:ring-2","focus:ring-primary-200",3,"input","value","placeholder"],[1,"px-4","py-3","text-sm","text-gray-900"],[1,"px-4","py-6","text-center","text-sm","text-gray-500"],[1,"rounded-lg","border","border-dashed","border-gray-300","bg-gray-50","p-8","text-center","text-sm","text-gray-500"]],template:function(t,r){if(t&1){let n=I();o(0,"div",1)(1,"div",2)(2,"div",3),k(3,Ee,2,11,"button",4,Te),l(),o(5,"div",5)(6,"input",6),S("change",function(a){return _(n),C(r.updateCustomStart((a.target==null?null:a.target.value)||""))}),l(),o(7,"span",7),p(8,"to"),l(),o(9,"input",6),S("change",function(a){return _(n),C(r.updateCustomEnd((a.target==null?null:a.target.value)||""))}),l(),o(10,"button",8),S("click",function(){return _(n),C(r.applyCustomRange())}),p(11," Apply "),l()()(),o(12,"div",9)(13,"div",10),T(14,ke,2,0,"div",11)(15,Pe,2,0),l(),o(16,"div",10),T(17,Fe,2,1,"app-card",12),o(18,"app-card",13)(19,"div",14)(20,"div",15)(21,"p",16),p(22),l(),o(23,"button",17),S("click",function(){return _(n),C(r.clearFilters())}),p(24," Clear filters "),l()(),o(25,"div",18)(26,"table",19)(27,"thead",20)(28,"tr"),k(29,Me,8,2,"th",21,U),l(),o(31,"tr",22),k(32,Ve,2,3,"th",23,U),l()(),o(34,"tbody",24),k(35,Oe,3,0,"tr",25,r.trackByRecord,!0,He,3,1,"tr"),l()()()()(),T(38,$e,2,0,"ng-template",null,0,ne),l()()()}if(t&2){let n=te(39);s(3),w(r.rangeOptions),s(3),h("value",r.customStart()||""),s(3),h("value",r.customEnd()||""),s(),h("disabled",!r.isCustomRangeValid()),s(4),E(r.employeeSummaries().length===0?14:15),s(3),h("ngIf",r.selectedEmployee())("ngIfElse",n),s(5),re(" Showing ",r.filteredTableData().length," of ",r.recordsCount()," records "),s(7),w(r.tableColumns),s(3),w(r.tableColumns),s(3),w(r.filteredTableData())}},dependencies:[V,ie,le,se,pe,oe,me,ce,ue],encapsulation:2})}return i})()});function Le(i,c){i&1&&(o(0,"div",3),p(1," Loading performance data\u2026 "),l())}function We(i,c){if(i&1&&(o(0,"div",4),p(1),l()),i&2){let e=f();s(),y(" ",e.error()," ")}}function je(i,c){if(i&1&&N(0,"app-performance-panel",5),i&2){let e=f();h("records",e.performanceData())}}var st,Ue=Z(()=>{M();j();_e();he();Ce();ge();M();st=(()=>{class i{dashboardService=B(fe);destroyRef=B(q);isLoading=b(!1);error=b(null);performanceData=b([]);ngOnInit(){this.loadPerformanceData()}loadPerformanceData(){this.isLoading.set(!0),this.error.set(null),this.dashboardService.getDashboardData().pipe(de(this.destroyRef),G(()=>this.isLoading.set(!1))).subscribe({next:e=>{this.performanceData.set(this.convertSheetToJson(e))},error:e=>{this.error.set(this.extractErrorMessage(e)),this.performanceData.set([])}})}convertSheetToJson(e){let t=e&&Array.isArray(e.values)?e.values:[];if(t.length===0)return[];let r=t[0].map(m=>m?String(m).trim():"");return t.slice(1).map(m=>{let a={};return r.forEach((d,g)=>{m[g]!==void 0&&m[g]!==null&&String(m[g]).trim()!==""&&(a[d||`col_${g+1}`]=m[g]!==void 0?m[g]:"")}),a})}extractErrorMessage(e){return e instanceof Error||e&&typeof e=="object"&&"message"in e&&typeof e.message=="string"?e.message:"Unable to load performance data. Please try again later."}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=A({type:i,selectors:[["app-performance"]],decls:9,vars:3,consts:[[1,"space-y-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"rounded-md","border","border-primary-200","bg-primary-50","px-4","py-3","text-sm","text-primary-800"],[1,"rounded-md","border","border-red-200","bg-red-50","px-4","py-3","text-sm","text-red-700"],[3,"records"]],template:function(t,r){t&1&&(o(0,"div",0)(1,"div")(2,"h1",1),p(3,"Performance"),l(),o(4,"p",2),p(5," Monitor employee drops, trends, and shift mix with interactive filters. "),l()(),T(6,Le,2,0,"div",3)(7,We,2,1,"div",4)(8,je,1,1,"app-performance-panel",5),l()),t&2&&(s(6),E(r.isLoading()?6:-1),s(),E(r.error()?7:-1),s(),E(!r.isLoading()&&!r.error()?8:-1))},dependencies:[V,ye],encapsulation:2})}return i})()});Ue();export{st as PerformanceComponent};
