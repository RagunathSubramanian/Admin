import{a as U,b as W,c as D,d as X}from"./chunk-F3C3DPQ7.js";import{b as I,c as l,d as $,e as j,g as G,h as M,i as q,j as B,k as P,o as R,q as L,r as J,s as H,t as Z}from"./chunk-OKMSR2WX.js";import"./chunk-DFADLG5I.js";import{a as z,b as Y,c as K,d as ee}from"./chunk-NI4BJD2M.js";import{$ as c,$a as x,Ba as m,Fa as b,Ka as S,Lb as k,Mb as V,Oa as A,Ob as T,T as v,Va as p,_a as w,aa as u,ab as h,bb as E,bc as N,cb as i,db as n,eb as f,hb as C,hc as Q,ib as s,jb as d,oa as y,rb as a,tb as F}from"./chunk-VUHZN6IL.js";import{d as O}from"./chunk-3A3XYTID.js";function te(o,g){if(o&1){let e=C();i(0,"div",15),f(1,"input",21),i(2,"button",22),s("click",function(){let t=c(e).$index,_=d(2);return u(_.removeAdminEmail(t))}),a(3," Remove "),n()()}if(o&2){let e=g.$implicit;m(),p("formControl",e)}}function ie(o,g){if(o&1){let e=C();i(0,"div",15),f(1,"input",23),i(2,"button",22),s("click",function(){let t=c(e).$index,_=d(2);return u(_.removeUserEmail(t))}),a(3," Remove "),n()()}if(o&2){let e=g.$implicit;m(),p("formControl",e)}}function re(o,g){if(o&1){let e=C();i(0,"app-card",3)(1,"p",12),a(2," Configure admin and user emails. Admin emails have full access to all features. User emails can access Dashboard and Performance pages but only see their own data without Amount fields. "),n(),i(3,"form",5)(4,"div")(5,"label",13),a(6," Admin Emails "),n(),i(7,"div",14),h(8,te,4,1,"div",15,x),n(),i(10,"button",16),s("click",function(){c(e);let t=d();return u(t.addAdminEmail())}),a(11," + Add Admin Email "),n()(),i(12,"div")(13,"label",13),a(14," User Emails "),n(),i(15,"div",17),h(16,ie,4,1,"div",15,x),n(),i(18,"button",16),s("click",function(){c(e);let t=d();return u(t.addUserEmail())}),a(19," + Add User Email "),n()(),i(20,"div",18)(21,"app-button",19),s("click",function(){c(e);let t=d();return u(t.resetConfig())}),a(22," Reset to Default "),n(),i(23,"app-button",20),s("click",function(){c(e);let t=d();return u(t.saveUserConfig())}),a(24),n()()()()}if(o&2){let e=d();m(3),p("formGroup",e.userConfigForm),m(5),E(e.adminEmailsArray.controls),m(8),E(e.userEmailsArray.controls),m(7),p("disabled",e.isSaving()),m(),F(" ",e.isSaving()?"Saving...":"Save Configuration"," ")}}var _e,ne=O(()=>{T();Q();J();ee();Y();Z();W();X();T();J();_e=(()=>{class o{fb;userConfigService=v(U);authService=v(D);profileForm;userConfigForm;isLoading=y(!1);isSaving=y(!1);isAdmin=k(()=>this.authService.isAdmin());get adminEmailsArray(){return this.userConfigForm.get("adminEmails")}get userEmailsArray(){return this.userConfigForm.get("userEmails")}constructor(e){this.fb=e,this.profileForm=this.fb.group({name:["John Doe"],email:["john@example.com"]}),this.userConfigForm=this.fb.group({adminEmails:this.fb.array([]),userEmails:this.fb.array([])}),V(()=>{let r=this.userConfigService.config();this.loadConfigIntoForm(r)})}loadConfigIntoForm(e){for(;this.adminEmailsArray.length;)this.adminEmailsArray.removeAt(0);for(;this.userEmailsArray.length;)this.userEmailsArray.removeAt(0);e.adminEmails.forEach(r=>{this.adminEmailsArray.push(this.fb.control(r,[l.required,l.email]))}),e.userEmails.forEach(r=>{this.userEmailsArray.push(this.fb.control(r,[l.required,l.email]))}),this.adminEmailsArray.length===0&&this.addAdminEmail()}addAdminEmail(){this.adminEmailsArray.push(this.fb.control("",[l.required,l.email]))}removeAdminEmail(e){this.adminEmailsArray.length>1&&this.adminEmailsArray.removeAt(e)}addUserEmail(){this.userEmailsArray.push(this.fb.control("",[l.required,l.email]))}removeUserEmail(e){this.userEmailsArray.removeAt(e)}saveUserConfig(){if(this.userConfigForm.valid){this.isSaving.set(!0);let e=this.adminEmailsArray.controls.map(t=>t.value?.trim().toLowerCase()).filter(t=>t),r=this.userEmailsArray.controls.map(t=>t.value?.trim().toLowerCase()).filter(t=>t);this.userConfigService.saveConfig({adminEmails:e,userEmails:r}),setTimeout(()=>{this.isSaving.set(!1),alert("Configuration saved successfully!")},500)}else this.userConfigForm.markAllAsTouched()}resetConfig(){confirm("Are you sure you want to reset to default configuration? This will remove all custom admin and user emails.")&&this.userConfigService.resetToDefault()}saveProfile(){console.log("Saving profile:",this.profileForm.value)}static \u0275fac=function(r){return new(r||o)(b(R))};static \u0275cmp=S({type:o,selectors:[["app-settings"]],decls:16,vars:2,consts:[[1,"space-y-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],["title","User Configuration"],["title","Profile Settings"],[1,"space-y-6",3,"formGroup"],["label","Name","inputId","name"],["id","name","type","text","formControlName","name",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-primary-500"],["label","Email","inputId","email"],["id","email","type","email","formControlName","email",1,"w-full","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-primary-500"],[1,"flex","justify-end"],["variant","primary",3,"click"],[1,"mb-4","text-sm","text-gray-600"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["formArrayName","adminEmails",1,"space-y-2"],[1,"flex","gap-2"],["type","button",1,"mt-2","px-4","py-2","text-sm","font-medium","text-primary-600","hover:text-primary-700","border","border-primary-300","rounded-lg","hover:bg-primary-50",3,"click"],["formArrayName","userEmails",1,"space-y-2"],[1,"flex","justify-end","gap-3"],["variant","secondary",3,"click"],["variant","primary",3,"click","disabled"],["type","email","placeholder","admin@example.com",1,"flex-1","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"formControl"],["type","button",1,"px-4","py-2","text-sm","font-medium","text-red-600","hover:text-red-700","border","border-red-300","rounded-lg","hover:bg-red-50",3,"click"],["type","email","placeholder","user@example.com",1,"flex-1","px-3","py-2","border","border-gray-300","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"formControl"]],template:function(r,t){r&1&&(i(0,"div",0)(1,"div")(2,"h1",1),a(3,"Settings"),n(),i(4,"p",2),a(5,"Manage your account settings and user configurations."),n()(),A(6,re,25,3,"app-card",3),i(7,"app-card",4)(8,"form",5)(9,"app-form-field",6),f(10,"input",7),n(),i(11,"app-form-field",8),f(12,"input",9),n(),i(13,"div",10)(14,"app-button",11),s("click",function(){return t.saveProfile()}),a(15," Save Changes "),n()()()()()),r&2&&(m(6),w(t.isAdmin()?6:-1),m(2),p("formGroup",t.profileForm))},dependencies:[N,L,G,I,$,j,M,q,P,B,K,z,H],encapsulation:2})}return o})()});ne();export{_e as SettingsComponent};
