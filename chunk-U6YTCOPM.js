import{a as me,b as Ce,c as de,d as ve}from"./chunk-TPTFHVLD.js";import{a as pe,b as he,c as ue,d as xe}from"./chunk-IH4XG7TN.js";import"./chunk-OCP6ILJ3.js";import{p as le,r as ye}from"./chunk-OKMSR2WX.js";import"./chunk-ZMABTEAI.js";import"./chunk-4QDCLFOO.js";import{c as se,d as fe}from"./chunk-NI4BJD2M.js";import{$ as E,$b as ie,A as Z,Ba as l,Bb as g,Cb as v,Db as k,Eb as U,Fb as te,K as ge,Ka as A,Lb as x,Mb as M,Oa as S,Ob as R,T as F,Va as f,Wa as H,Xa as L,Ya as J,Yb as re,Za as K,Zb as ae,_a as w,_b as ne,aa as _,ab as W,ac as oe,bb as O,bc as B,cb as i,db as o,eb as T,fb as Q,ga as q,gb as X,hb as I,hc as $,ib as N,jb as C,oa as D,qb as ee,rb as p,sb as V,tb as c}from"./chunk-VUHZN6IL.js";import{a as j,b as G,d as Y}from"./chunk-3A3XYTID.js";function ke(u,y){if(u&1){let e=I();i(0,"button",16),N("click",function(){let a=E(e).$implicit,r=C();return _(r.setRange(a.value))}),p(1),o()}if(u&2){let e=y.$implicit,t=C();L("bg-primary-600",t.performanceRange()===e.value)("text-white",t.performanceRange()===e.value)("border-primary-600",t.performanceRange()===e.value)("border-gray-200",t.performanceRange()!==e.value)("text-gray-600",t.performanceRange()!==e.value),l(),c(" ",e.label," ")}}function Ee(u,y){u&1&&(i(0,"div",11),p(1," No employees found for the selected range. "),o())}function _e(u,y){if(u&1){let e=I();i(0,"button",18),N("click",function(){let a=E(e).$implicit,r=C(2);return _(r.selectEmployee(a.id))}),i(1,"div",19)(2,"div",20),p(3),o(),i(4,"div",21)(5,"div",22)(6,"div")(7,"p",23),p(8),o(),i(9,"p",24),p(10),g(11,"date"),o()(),i(12,"div",25)(13,"p",26),p(14,"Drop Count"),o(),i(15,"p",27),p(16),g(17,"number"),o()()(),i(18,"div",28)(19,"div",29),p(20," Avg / Day: "),i(21,"span",30),p(22),g(23,"number"),o()(),i(24,"div",31)(25,"span"),p(26),o(),i(27,"span",29),p(28),g(29,"percent"),o()()()()()()}if(u&2){let e,t,a,r=y.$implicit,s=C(2);L("border-primary-500",((e=s.selectedEmployee())==null?null:e.id)===r.id)("bg-primary-50",((t=s.selectedEmployee())==null?null:t.id)===r.id)("border-gray-200",((a=s.selectedEmployee())==null?null:a.id)!==r.id),l(2),H("background-color",r.avatarColor),l(),c(" ",r.initials," "),l(5),V(r.name),l(2),c(" ",r.hireDate?k(11,17,r.hireDate,"mediumDate"):"Hire date unknown"," "),l(6),c(" ",v(17,20,r.totalDrops)," "),l(6),c(" ",k(23,22,r.averageDropsPerDay,"1.0-1")," "),l(3),J(s.getTrendClasses(r.trendDirection)),l(),c(" ",s.getTrendIcon(r.trendDirection)," "),l(2),c(" ",k(29,25,r.percentageOfTotal,"1.0-1")," ")}}function we(u,y){if(u&1&&W(0,_e,30,28,"button",17,K().trackByEmployeeId,!0),u&2){let e=C();O(e.employeeSummaries())}}function Ne(u,y){if(u&1&&(Q(0),i(1,"div",34)(2,"div",35)(3,"div",36)(4,"div",20),p(5),o(),i(6,"div")(7,"p",37),p(8),o(),i(9,"p",38),p(10),g(11,"date"),o()()(),i(12,"div",25)(13,"p",26),p(14,"Contribution"),o(),i(15,"p",39),p(16),g(17,"percent"),o()()(),i(18,"div",40)(19,"div",41)(20,"p",42),p(21,"Drop Count"),o(),i(22,"p",43),p(23),g(24,"number"),o(),i(25,"p",44),p(26),g(27,"number"),o(),i(28,"p",44),p(29),g(30,"number"),o(),i(31,"p",44),p(32),g(33,"number"),o(),i(34,"p",44),p(35),g(36,"number"),o(),i(37,"p",44),p(38),g(39,"number"),o()(),i(40,"div",41)(41,"p",42),p(42,"Average / Day"),o(),i(43,"p",43),p(44),g(45,"number"),o(),i(46,"p",44),p(47),g(48,"number"),o()(),i(49,"div",41)(50,"p",42),p(51,"Amount"),o(),i(52,"p",43),p(53),g(54,"currency"),o()(),i(55,"div",41)(56,"p",42),p(57,"Average Amount / Day"),o(),i(58,"p",43),p(59),g(60,"currency"),o()()(),i(61,"div",45),T(62,"app-chart-wrapper",46)(63,"app-chart-wrapper",47),o(),T(64,"app-chart-wrapper",48),o(),X()),u&2){let e=y.ngIf,t=C(2);l(4),H("background-color",e.avatarColor),l(),c(" ",e.initials," "),l(3),V(e.name),l(2),c(" Hired: ",e.hireDate?k(11,25,e.hireDate,"longDate"):"Unknown"," "),l(6),c(" ",k(17,28,e.percentageOfTotal,"1.0-1")," "),l(7),c(" ",v(24,31,e.totalDrops)," "),l(3),c(" Single drops: ",v(27,33,e.totalDrops-e.multiDrops-e.heavyDrops-e.doubleDrops)," "),l(3),c(" Multi drops: ",v(30,35,e.multiDrops)," "),l(3),c(" Heavy drops: ",v(33,37,e.heavyDrops)," "),l(3),c(" Walkup drops: ",v(36,39,e.walkupDrops)," "),l(3),c(" Double drops: ",v(39,41,e.doubleDrops)," "),l(6),c(" ",k(45,43,e.averageDropsPerDay,"1.0-1")," "),l(3),c(" Day Count : ",v(48,46,e.dailyTotals.size)," "),l(6),c(" ",U(54,48,e.amount,"$ ","symbol","1.0-0")," "),l(6),c(" ",U(60,53,e.averageAmountPerDay,"$ ","symbol","1.0-0")," "),l(3),f("chartData",t.employeeTrendChartData())("chartOptions",t.employeeTrendChartOptions)("chartType",t.lineChartType),l(),f("chartData",t.employeeDropTypeChartData())("chartOptions",t.employeeDropTypeChartOptions)("chartType",t.pieChartType),l(),f("chartData",t.employeeShiftChartData())("chartOptions",t.employeeShiftChartOptions)("chartType",t.barChartType)}}function Pe(u,y){if(u&1&&(i(0,"app-card",32),S(1,Ne,65,58,"ng-container",33),o()),u&2){let e=C();l(),f("ngIf",e.selectedEmployee())}}function Ae(u,y){u&1&&(i(0,"div",49),p(1," Select an employee to view detailed performance charts. "),o())}var Te,ce,be=Y(()=>{"use strict";R();$();ye();fe();he();xe();R();$();Te=(u,y)=>y.value;ce=(()=>{class u{avatarPalette=["#2563eb","#16a34a","#ea580c","#9333ea","#0ea5e9","#f97316","#dc2626","#14b8a6"];recordsSignal=D([]);tabledata=D([]);set records(e){this.recordsSignal.set(Array.isArray(e)?e:[]),this.tabledata.set(this.filteredTableData()||[])}performanceRange=D("month");customStart=D(null);customEnd=D(null);selectedEmployeeId=D(null);rangeOptions=[{label:"Today",value:"today"},{label:"This Week",value:"week"},{label:"This Month",value:"month"},{label:"This Year",value:"year"}];filteredRecords=x(()=>{let e=this.recordsSignal(),t=this.performanceRange(),a=this.customStart(),r=this.customEnd(),{startDate:s,endDate:n}=this.getRangeBounds(t,a,r);if(!s&&!n)return e;var m=e.filter(d=>{let h=this.parseRecordDate(d);return!(!h||s&&h<s||n&&h>n)});return m});employeeSummaries=x(()=>{let e=this.filteredRecords();if(!e.length)return[];let t=new Map;e.forEach(n=>{let m=n.FIN||n.NAME||`employee-${n.Timestamp}`,d=n.NAME?.trim()||"Unknown",h=this.getInitials(d),b=t.get(m)||{id:m,name:d,initials:h,totalDrops:0,hireDate:null,dailyTotals:new Map,dropTypes:{"Single Drops":0,"Multi Drops":0,"Heavy Drops":0,"Walkup Drop Count":0,"Double Drop Count":0},shifts:new Set,amount:0,multiDrops:0,heavyDrops:0,walkupDrops:0,doubleDrops:0,records:[]},P=this.parseRecordDate(n);if(P){b.hireDate=this.getEarlierDate(b.hireDate,P);let z=this.formatDateKey(P),De=b.dailyTotals.get(z)??0;b.dailyTotals.set(z,De+this.ensureNumber(n.DropCount))}b.totalDrops+=this.ensureNumber(n.DropCount),b.amount+=this.ensureNumber(n.Amount),b.multiDrops+=this.ensureNumber(n["Multi Drops"]),b.heavyDrops+=this.ensureNumber(n["Heavy Drops"]),b.walkupDrops+=this.ensureNumber(n["Walkup Drop Count"]),b.doubleDrops+=this.ensureNumber(n["Double Drop Count"]),b.dropTypes["Single Drops"]+=this.ensureNumber(n.DropCount-n["Multi Drops"]-n["Heavy Drops"]-n["Double Drop Count"]),b.dropTypes["Multi Drops"]+=this.ensureNumber(n["Multi Drops"]),b.dropTypes["Heavy Drops"]+=this.ensureNumber(n["Heavy Drops"]),b.dropTypes["Walkup Drop Count"]+=this.ensureNumber(n["Walkup Drop Count"]),b.dropTypes["Double Drop Count"]+=this.ensureNumber(n["Double Drop Count"]),n.Shift&&b.shifts.add(n.Shift),b.records.push(n),t.set(m,b)});let a=Array.from(t.values()),r=a.reduce((n,m)=>n+m.totalDrops,0),s=a.length?r/a.length:0;return a.map((n,m)=>{let d=n.dailyTotals.size||1,h=n.totalDrops/d,b=n.amount/d,P=n.totalDrops>s?"up":n.totalDrops<s?"down":"flat";return{id:n.id,name:n.name,initials:n.initials,avatarColor:this.avatarPalette[m%this.avatarPalette.length],totalDrops:n.totalDrops,averageDropsPerDay:h,averageAmountPerDay:b,hireDate:n.hireDate,percentageOfTotal:r?n.totalDrops/r:0,trendDirection:P,dailyTotals:n.dailyTotals,dropTypes:n.dropTypes,shifts:Array.from(n.shifts),amount:n.amount,multiDrops:n.multiDrops,heavyDrops:n.heavyDrops,walkupDrops:n.walkupDrops,doubleDrops:n.doubleDrops,records:n.records}}).sort((n,m)=>m.totalDrops-n.totalDrops)});selectedEmployee=x(()=>{let e=this.selectedEmployeeId(),t=this.employeeSummaries();if(!t.length)return null;if(e){let a=t.find(r=>r.id===e);if(a)return a}return t[0]});employeeTrendChartData=x(()=>{let e=this.selectedEmployee();if(!e)return this.createLineChartData([],[],"Daily Drops",{background:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 1)"});let t=Array.from(e.dailyTotals.keys()).sort(),a=t.map(s=>this.formatDisplayDate(s)),r=t.map(s=>e.dailyTotals.get(s)??0);return this.createLineChartData(a,r,"Daily Drops",{background:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 1)"})});employeeTrendChartOptions={elements:{line:{tension:.4}},scales:{y:{beginAtZero:!0}},plugins:{legend:{display:!1}},responsive:!0,maintainAspectRatio:!1};employeeDropTypeChartData=x(()=>{let e=this.selectedEmployee();if(!e)return this.createPieChartData([],[]);let t=Object.entries(e.dropTypes).filter(([,a])=>this.ensureNumber(a)>0);return t.length?this.createPieChartData(t.map(([a])=>a),t.map(([,a])=>a),["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"]):this.createPieChartData([],[])});employeeDropTypeChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}};employeeShiftChartData=x(()=>{let e=this.selectedEmployee();if(!e)return this.createBarChartData([],[],"Drops by Shift");let t=this.groupAndSumByDropCount(e.records,a=>a.Shift||"Unassigned");return this.createBarChartData(t.labels,t.values,"Drops by Shift",{background:"rgba(22, 163, 74, 0.8)",border:"rgba(22, 163, 74, 1)"})});employeeShiftChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};isCustomRangeValid=x(()=>{let e=this.customStart(),t=this.customEnd();if(!e||!t)return!1;let a=new Date(e),r=new Date(t);return a.setHours(0,0,0,0),r.setHours(0,0,0,0),a<=r});lineChartType="line";pieChartType="pie";barChartType="bar";constructor(){M(()=>{let e=this.employeeSummaries(),t=this.selectedEmployeeId();if(!e.length){t!==null&&this.selectedEmployeeId.set(null);return}(t?e.some(r=>r.id===t):!1)||this.selectedEmployeeId.set(e[0].id)}),M(()=>{let e=this.groupedTableData();this.groupedTableDataSignal.set(e)}),M(()=>{let e=this.dropRecordsTableData();this.dropRecordsTableDataSignal.set(e)})}setRange(e){this.performanceRange.set(e),this.tabledata.set(this.filteredTableData()||[]),e!=="custom"&&(this.customStart.set(null),this.customEnd.set(null))}applyCustomRange(){this.isCustomRangeValid()&&this.performanceRange.set("custom")}updateCustomStart(e){this.customStart.set(e||null),this.customStart.set(e||null)}updateCustomEnd(e){this.customEnd.set(e||null)}selectEmployee(e){this.selectedEmployeeId.set(e),this.tabledata.set(this.filteredTableData()||[])}trackByEmployeeId(e,t){return t.id}getRangeBounds(e,t,a){let r=new Date,s=new Date(r.getFullYear(),r.getMonth(),r.getDate());switch(e){case"today":return{startDate:s,endDate:new Date(s.getTime()+24*60*60*1e3-1)};case"week":{let n=new Date(s);return n.setDate(n.getDate()-6),{startDate:n,endDate:r}}case"month":return{startDate:new Date(r.getFullYear(),r.getMonth(),1),endDate:r};case"year":return{startDate:new Date(r.getFullYear(),0,1),endDate:r};case"custom":{let n=t?new Date(new Date(t).setHours(0,0,0,0)):null,m=a?new Date(new Date(a).setHours(0,0,0,0)):null;return{startDate:n,endDate:m}}default:return{startDate:null,endDate:null}}}parseRecordDate(e){let t=e.DATE||e.Timestamp;if(!t)return null;let a=new Date(t);return Number.isNaN(a.getTime())?null:a}getInitials(e){let t=e.split(" ").filter(Boolean);return t.length===0?"?":t.length===1?t[0].slice(0,2).toUpperCase():(t[0][0]+t[t.length-1][0]).toUpperCase()}ensureNumber(e){if(typeof e=="number")return Number.isFinite(e)?e:0;let t=Number(e);return Number.isFinite(t)?t:0}getEarlierDate(e,t){return e?t<e?t:e:t}formatDateKey(e){let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${a}-${r}`}formatDisplayDate(e){let t=e.split("-");if(t.length!==3)return e;let[a,r,s]=t,n=Number(a),m=Number(r),d=Number(s);return!n||!m||!d?e:new Date(n,m-1,d).toLocaleDateString(void 0,{month:"short",day:"numeric"})}createLineChartData(e,t,a,r){return{labels:e,datasets:[{data:t,label:a,backgroundColor:r.background,borderColor:r.border,pointBackgroundColor:r.border,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:r.border,fill:"origin"}]}}createBarChartData(e,t,a,r={background:"rgba(59, 130, 246, 0.8)",border:"rgba(59, 130, 246, 1)"}){return{labels:e,datasets:[{data:t,label:a,backgroundColor:r.background,borderColor:r.border,borderWidth:1}]}}createPieChartData(e,t,a=[]){return{labels:e,datasets:[{data:t,backgroundColor:a.length>0?a:["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"],borderColor:"#fff",borderWidth:1}]}}groupAndSum(e,t,a){let r=new Map;e.forEach(m=>{let d=t(m)||"Unknown",h=r.get(d)??0,b=this.ensureNumber(m[a]);r.set(d,h+b)});let s=Array.from(r.keys()),n=s.map(m=>r.get(m)??0);return{labels:s,values:n}}groupAndSumByDropCount(e,t){let a=new Map;e.forEach(n=>{let m=t(n)||"Unknown",h=(a.get(m)??0)+this.ensureNumber(n.DropCount);a.set(m,h)});let r=Array.from(a.keys()),s=r.map(n=>a.get(n)??0);return{labels:r,values:s}}getTrendIcon(e){switch(e){case"up":return"\u2191";case"down":return"\u2193";default:return"\u2192"}}getTrendClasses(e){switch(e){case"up":return"text-green-600";case"down":return"text-red-600";default:return"text-gray-500"}}recordsCount=x(()=>this.filteredRecords().length);tableColumns=[{key:"DATE",label:"Date",type:"text"},{key:"NAME",label:"Name",type:"text"},{key:"Shift",label:"Shift",type:"text"},{key:"Total Drops",label:"Total Drops",type:"number",numeric:!0},{key:"Multi Drops",label:"Multi Drops",type:"number",numeric:!0},{key:"Heavy Drops",label:"Heavy Drops",type:"number",numeric:!0},{key:"Walkup Drop Count",label:"Walkup Drops",type:"number",numeric:!0},{key:"Double Drop Count",label:"Double Drops",type:"number",numeric:!0},{key:"Amount",label:"Amount",type:"number",numeric:!0}];BydaytableColumns=[{key:"DATE",label:"Date",type:"text"},{key:"NAME",label:"Name",type:"text"},{key:"Total Drops",label:"Total Drops",type:"number",numeric:!0},{key:"Multi Drops",label:"Multi Drops",type:"number",numeric:!0},{key:"Heavy Drops",label:"Heavy Drops",type:"number",numeric:!0},{key:"Walkup Drop Count",label:"Walkup Drops",type:"number",numeric:!0},{key:"Double Drop Count",label:"Double Drops",type:"number",numeric:!0},{key:"Amount",label:"Amount",type:"number",numeric:!0}];tableFilters=D(this.tableColumns.reduce((e,t)=>(e[t.key]="",e),{}));sortState=D(null);filteredTableData=x(()=>this.selectedEmployee()?.records||[]);groupedTableData=x(()=>{let e=this.filteredTableData();if(!e.length)return[];let t=new Map;return e.forEach(r=>{let s=r.DATE||"Unknown",n=r.NAME||"Unknown",m=`${s}|${n}`,d=t.get(m);d?(d["Total Drops"]+=this.ensureNumber(r["Total Drops"]),d["Multi Drops"]+=this.ensureNumber(r["Multi Drops"]),d["Heavy Drops"]+=this.ensureNumber(r["Heavy Drops"]),d["Walkup Drop Count"]+=this.ensureNumber(r["Walkup Drop Count"]),d["Double Drop Count"]+=this.ensureNumber(r["Double Drop Count"]),d.Amount+=this.ensureNumber(r.Amount),d.DropCount+=this.ensureNumber(r.DropCount||0)):t.set(m,{DATE:s,NAME:n,"Total Drops":this.ensureNumber(r["Total Drops"]),"Multi Drops":this.ensureNumber(r["Multi Drops"]),"Heavy Drops":this.ensureNumber(r["Heavy Drops"]),"Walkup Drop Count":this.ensureNumber(r["Walkup Drop Count"]),"Double Drop Count":this.ensureNumber(r["Double Drop Count"]),Amount:this.ensureNumber(r.Amount),DropCount:this.ensureNumber(r.DropCount||0)})}),Array.from(t.values()).sort((r,s)=>{let n=this.parseRecordDate({DATE:r.DATE}),m=this.parseRecordDate({DATE:s.DATE});return!n&&!m?0:n?m?m.getTime()-n.getTime():-1:1})});groupedTableDataSignal=D([]);groupedTablePageSize=D(10);dropRecordsTableData=x(()=>{let e=this.filteredTableData();return e.length?[...e].sort((t,a)=>{let r=this.parseRecordDate(t),s=this.parseRecordDate(a);return!r&&!s?0:r?s?s.getTime()-r.getTime():-1:1}):[]});dropRecordsTableDataSignal=D([]);dropRecordsTablePageSize=D(10);dropRecordsTableColumns=[{key:"DATE",label:"Date",sortable:!0,filterable:!0},{key:"NAME",label:"Name",sortable:!0,filterable:!0},{key:"Shift",label:"Shift",sortable:!0,filterable:!0},{key:"Total Drops",label:"Total Drops",sortable:!0,render:e=>this.ensureNumber(e["Total Drops"]).toLocaleString()},{key:"Multi Drops",label:"Multi Drops",sortable:!0,render:e=>this.ensureNumber(e["Multi Drops"]).toLocaleString()},{key:"Heavy Drops",label:"Heavy Drops",sortable:!0,render:e=>this.ensureNumber(e["Heavy Drops"]).toLocaleString()},{key:"Walkup Drop Count",label:"Walkup Drops",sortable:!0,render:e=>this.ensureNumber(e["Walkup Drop Count"]).toLocaleString()},{key:"Double Drop Count",label:"Double Drops",sortable:!0,render:e=>this.ensureNumber(e["Double Drop Count"]).toLocaleString()},{key:"Amount",label:"Amount",sortable:!0,render:e=>new Intl.NumberFormat(void 0,{style:"currency",currency:"SGD",maximumFractionDigits:0}).format(this.ensureNumber(e.Amount))}];groupedTableColumns=[{key:"DATE",label:"Date",sortable:!0,filterable:!0},{key:"NAME",label:"Name",sortable:!0,filterable:!0},{key:"Total Drops",label:"Total Drops",sortable:!0,render:e=>e["Total Drops"].toLocaleString()},{key:"Multi Drops",label:"Multi Drops",sortable:!0,render:e=>e["Multi Drops"].toLocaleString()},{key:"Heavy Drops",label:"Heavy Drops",sortable:!0,render:e=>e["Heavy Drops"].toLocaleString()},{key:"Walkup Drop Count",label:"Walkup Drops",sortable:!0,render:e=>e["Walkup Drop Count"].toLocaleString()},{key:"Double Drop Count",label:"Double Drops",sortable:!0,render:e=>e["Double Drop Count"].toLocaleString()},{key:"Amount",label:"Amount",sortable:!0,render:e=>new Intl.NumberFormat(void 0,{style:"currency",currency:"SGD",maximumFractionDigits:0}).format(e.Amount)},{key:"DropCount",label:"Drop Count",sortable:!0,render:e=>e.DropCount.toLocaleString()}];updateFilter(e,t){this.tableFilters.update(a=>G(j({},a),{[e]:t}))}clearFilters(){this.tableFilters.set(this.tableColumns.reduce((e,t)=>(e[t.key]="",e),{}))}toggleSort(e){this.sortState.update(t=>!t||t.key!==e?{key:e,direction:"asc"}:t.direction==="asc"?{key:e,direction:"desc"}:null)}getSortDirection(e){return this.sortState()?.key===e?this.sortState().direction:null}getFilterValue(e){return this.tableFilters()[e]??""}formatCellValue(e,t){let a=e[t.key];return a==null?"\u2014":t.key==="Amount"?new Intl.NumberFormat(void 0,{style:"currency",currency:"SGD",maximumFractionDigits:0}).format(this.ensureNumber(a)):t.key==="Timestamp"?this.formatTimestamp(String(a)):String(a)}trackByRecord=(e,t)=>t.Timestamp||t.FIN||e;formatTimestamp(e){if(!e)return"Unknown time";let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})}static \u0275fac=function(t){return new(t||u)};static \u0275cmp=A({type:u,selectors:[["app-performance-panel"]],inputs:{records:"records"},decls:26,vars:20,consts:[["noSelection",""],[1,"space-y-6"],[1,"flex","flex-col","gap-3","lg:flex-row","lg:items-center","lg:justify-between"],[1,"flex","flex-wrap","gap-2"],["type","button",1,"rounded-full","border","px-4","py-1.5","text-sm","font-medium","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"bg-primary-600","text-white","border-primary-600","border-gray-200","text-gray-600"],[1,"flex","flex-wrap","items-center","gap-2"],["type","date",1,"rounded-md","border","border-gray-300","px-3","py-1.5","text-sm","focus:border-primary-500","focus:outline-none","focus:ring-2","focus:ring-primary-200",3,"change","value"],[1,"text-sm","text-gray-400"],["type","button",1,"rounded-md","bg-primary-600","px-4","py-1.5","text-sm","font-medium","text-white","transition","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","disabled:bg-gray-300","disabled:text-gray-500",3,"click","disabled"],[1,"grid","grid-cols-1","gap-6","lg:grid-cols-[320px_minmax(0,1fr)]"],[1,"space-y-4"],[1,"rounded-lg","border","border-dashed","border-gray-300","bg-gray-50","p-6","text-center","text-sm","text-gray-500"],["title","Performance Overview","padding","sm",4,"ngIf","ngIfElse"],["title","Grouped Summary","subtitle","Grouped by Date and Name (excluding Shift)","padding","sm"],[3,"columns","data","pagination","pageSize","showToolbar","showFilters","searchable"],["title","Drop Records","subtitle","All records ordered by date (newest first)","padding","sm"],["type","button",1,"rounded-full","border","px-4","py-1.5","text-sm","font-medium","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"click"],["type","button",1,"w-full","rounded-xl","border","px-4","py-4","text-left","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"border-primary-500","bg-primary-50","border-gray-200"],["type","button",1,"w-full","rounded-xl","border","px-4","py-4","text-left","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"click"],[1,"flex","items-start","gap-4"],[1,"flex","h-12","w-12","items-center","justify-center","rounded-full","text-lg","font-semibold","text-white"],[1,"flex-1","space-y-2"],[1,"flex","items-center","justify-between","gap-2"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"text-right"],[1,"text-xs","text-gray-400"],[1,"text-sm","font-semibold","text-gray-900"],[1,"flex","items-center","justify-between","gap-2","text-xs"],[1,"text-gray-500"],[1,"font-medium","text-gray-900"],[1,"flex","items-center","gap-1"],["title","Performance Overview","padding","sm"],[4,"ngIf"],[1,"flex","flex-col","gap-4"],[1,"flex","flex-wrap","items-center","justify-between","gap-3"],[1,"flex","items-center","gap-3"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"text-base","font-medium","text-gray-900"],[1,"grid","grid-cols-2","gap-4","md:grid-cols-4"],[1,"rounded-lg","border","border-gray-200","bg-gray-50","p-3"],[1,"text-xs","uppercase","text-gray-400"],[1,"mt-1","text-lg","font-semibold","text-gray-900"],[1,"mt-1","text-xs","text-gray-500"],[1,"grid","grid-cols-1","gap-4","lg:grid-cols-2"],["title","Daily Drops Trend","subtitle","Drops completed per day","height","240px",3,"chartData","chartOptions","chartType"],["title","Drop Distribution","subtitle","Mix of drop types","height","240px",3,"chartData","chartOptions","chartType"],["title","Drops by Shift","subtitle","Shift allocation for this team member","height","240px",3,"chartData","chartOptions","chartType"],[1,"rounded-lg","border","border-dashed","border-gray-300","bg-gray-50","p-8","text-center","text-sm","text-gray-500"]],template:function(t,a){if(t&1){let r=I();i(0,"div",1)(1,"div",2)(2,"div",3),W(3,ke,2,11,"button",4,Te),o(),i(5,"div",5)(6,"input",6),N("change",function(n){return E(r),_(a.updateCustomStart((n.target==null?null:n.target.value)||""))}),o(),i(7,"span",7),p(8,"to"),o(),i(9,"input",6),N("change",function(n){return E(r),_(a.updateCustomEnd((n.target==null?null:n.target.value)||""))}),o(),i(10,"button",8),N("click",function(){return E(r),_(a.applyCustomRange())}),p(11," Apply "),o()()(),i(12,"div",9)(13,"div",10),S(14,Ee,2,0,"div",11)(15,we,2,0),o(),i(16,"div",10),S(17,Pe,2,1,"app-card",12),i(18,"section")(19,"app-card",13),T(20,"app-data-table",14),o()(),i(21,"section")(22,"app-card",15),T(23,"app-data-table",14),o()(),S(24,Ae,2,0,"ng-template",null,0,te),o()()()}if(t&2){let r=ee(25);l(3),O(a.rangeOptions),l(3),f("value",a.customStart()||""),l(3),f("value",a.customEnd()||""),l(),f("disabled",!a.isCustomRangeValid()),l(4),w(a.employeeSummaries().length===0?14:15),l(3),f("ngIf",a.selectedEmployee())("ngIfElse",r),l(3),f("columns",a.groupedTableColumns)("data",a.groupedTableDataSignal)("pagination",!0)("pageSize",a.groupedTablePageSize)("showToolbar",!1)("showFilters",!0)("searchable",!1),l(3),f("columns",a.dropRecordsTableColumns)("data",a.dropRecordsTableDataSignal)("pagination",!0)("pageSize",a.dropRecordsTablePageSize)("showToolbar",!1)("showFilters",!0)("searchable",!1)}},dependencies:[B,re,ne,ie,oe,ae,le,se,pe,ue],encapsulation:2})}return u})()});function Ie(u,y){u&1&&(i(0,"div",3),p(1," Loading performance data\u2026 "),o())}function Me(u,y){if(u&1&&(i(0,"div",4),p(1),o()),u&2){let e=C();l(),c(" ",e.error()," ")}}function Re(u,y){if(u&1&&T(0,"app-performance-panel",5),u&2){let e=C();f("records",e.performanceData())}}var et,Be=Y(()=>{R();$();Ce();ge();ve();be();R();et=(()=>{class u{dashboardService=F(de);destroyRef=F(q);isLoading=D(!1);error=D(null);performanceData=D([]);ngOnInit(){this.loadPerformanceData()}loadPerformanceData(){this.isLoading.set(!0),this.error.set(null),this.dashboardService.getDashboardData().pipe(me(this.destroyRef),Z(()=>this.isLoading.set(!1))).subscribe({next:e=>{console.log("Performance Data Loaded:",e),this.performanceData.set(e)},error:e=>{this.error.set(this.extractErrorMessage(e)),this.performanceData.set([])}})}extractErrorMessage(e){return e instanceof Error||e&&typeof e=="object"&&"message"in e&&typeof e.message=="string"?e.message:"Unable to load performance data. Please try again later."}static \u0275fac=function(t){return new(t||u)};static \u0275cmp=A({type:u,selectors:[["app-performance"]],decls:9,vars:3,consts:[[1,"space-y-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"rounded-md","border","border-primary-200","bg-primary-50","px-4","py-3","text-sm","text-primary-800"],[1,"rounded-md","border","border-red-200","bg-red-50","px-4","py-3","text-sm","text-red-700"],[3,"records"]],template:function(t,a){t&1&&(i(0,"div",0)(1,"div")(2,"h1",1),p(3,"Performance"),o(),i(4,"p",2),p(5," Monitor employee drops, trends, and shift mix with interactive filters. "),o()(),S(6,Ie,2,0,"div",3)(7,Me,2,1,"div",4)(8,Re,1,1,"app-performance-panel",5),o()),t&2&&(l(6),w(a.isLoading()?6:-1),l(),w(a.error()?7:-1),l(),w(!a.isLoading()&&!a.error()?8:-1))},dependencies:[B,ce],encapsulation:2})}return u})()});Be();export{et as PerformanceComponent};
