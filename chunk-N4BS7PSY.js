import{a as me,b as Ce,c as de,d as ve}from"./chunk-HO3NFZVI.js";import{a as pe,b as he,c as ue,d as xe}from"./chunk-TM6KB5IX.js";import"./chunk-OCP6ILJ3.js";import"./chunk-K57REIZM.js";import"./chunk-CRRLMRTS.js";import{n as le,p as De}from"./chunk-SZIHL77V.js";import{c as se,d as ye}from"./chunk-5HYCXBJG.js";import"./chunk-PYB7RU6R.js";import{$ as k,$a as L,$b as oe,A as Z,Ab as x,Ba as s,Bb as V,Cb as S,Db as U,Eb as te,K as ge,Ka as N,Kb as y,Lb as I,Nb as M,Oa as v,T as F,Va as D,Wa as B,Xa as H,Ya as J,Yb as re,Za as K,Zb as ae,_a as _,_b as ne,aa as E,ab as O,ac as ie,bb as o,bc as R,cb as i,db as T,eb as Q,fb as X,ga as q,gb as A,hb as w,ib as h,ic as z,oa as b,pb as ee,qb as u,rb as W,sb as f}from"./chunk-ZWOVSD7C.js";import{a as $,b as G,d as Y}from"./chunk-3A3XYTID.js";function ke(l,g){if(l&1){let e=A();o(0,"button",16),w("click",function(){let a=k(e).$implicit,r=h();return E(r.setRange(a.value))}),u(1),i()}if(l&2){let e=g.$implicit,t=h();H("bg-primary-600",t.performanceRange()===e.value)("text-white",t.performanceRange()===e.value)("border-primary-600",t.performanceRange()===e.value)("border-gray-200",t.performanceRange()!==e.value)("text-gray-600",t.performanceRange()!==e.value),s(),f(" ",e.label," ")}}function Ee(l,g){l&1&&(o(0,"div",11),u(1," No employees found for the selected range. "),i())}function _e(l,g){if(l&1){let e=A();o(0,"button",18),w("click",function(){let a=k(e).$implicit,r=h(2);return E(r.selectEmployee(a.id))}),o(1,"div",19)(2,"div",20),u(3),i(),o(4,"div",21)(5,"div",22)(6,"div")(7,"p",23),u(8),i(),o(9,"p",24),u(10),x(11,"date"),i()(),o(12,"div",25)(13,"p",26),u(14,"Total Drops"),i(),o(15,"p",27),u(16),x(17,"number"),i()()(),o(18,"div",28)(19,"div",29),u(20," Avg / Day: "),o(21,"span",30),u(22),x(23,"number"),i()(),o(24,"div",31)(25,"span"),u(26),i(),o(27,"span",29),u(28),x(29,"percent"),i()()()()()()}if(l&2){let e,t,a,r=g.$implicit,p=h(2);H("border-primary-500",((e=p.selectedEmployee())==null?null:e.id)===r.id)("bg-primary-50",((t=p.selectedEmployee())==null?null:t.id)===r.id)("border-gray-200",((a=p.selectedEmployee())==null?null:a.id)!==r.id),s(2),B("background-color",r.avatarColor),s(),f(" ",r.initials," "),s(5),W(r.name),s(2),f(" ",r.hireDate?S(11,17,r.hireDate,"mediumDate"):"Hire date unknown"," "),s(6),f(" ",V(17,20,r.totalDrops)," "),s(6),f(" ",S(23,22,r.averageDropsPerDay,"1.0-1")," "),s(3),J(p.getTrendClasses(r.trendDirection)),s(),f(" ",p.getTrendIcon(r.trendDirection)," "),s(2),f(" ",S(29,25,r.percentageOfTotal,"1.0-1")," ")}}function we(l,g){if(l&1&&L(0,_e,30,28,"button",17,K().trackByEmployeeId,!0),l&2){let e=h();O(e.employeeSummaries())}}function Pe(l,g){if(l&1&&(Q(0),o(1,"div",34)(2,"div",35)(3,"div",36)(4,"div",20),u(5),i(),o(6,"div")(7,"p",37),u(8),i(),o(9,"p",38),u(10),x(11,"date"),i()()(),o(12,"div",25)(13,"p",26),u(14,"Contribution"),i(),o(15,"p",39),u(16),x(17,"percent"),i()()(),o(18,"div",40)(19,"div",41)(20,"p",42),u(21,"Total Drops"),i(),o(22,"p",43),u(23),x(24,"number"),i()(),o(25,"div",41)(26,"p",42),u(27,"Average / Day"),i(),o(28,"p",43),u(29),x(30,"number"),i()(),o(31,"div",41)(32,"p",42),u(33,"Amount"),i(),o(34,"p",43),u(35),x(36,"currency"),i()(),o(37,"div",41)(38,"p",42),u(39,"Average Amount / Day"),i(),o(40,"p",43),u(41),x(42,"currency"),i()()(),o(43,"div",44),T(44,"app-chart-wrapper",45)(45,"app-chart-wrapper",46),i(),T(46,"app-chart-wrapper",47),i(),X()),l&2){let e=g.ngIf,t=h(2);s(4),B("background-color",e.avatarColor),s(),f(" ",e.initials," "),s(3),W(e.name),s(2),f(" Hired: ",e.hireDate?S(11,19,e.hireDate,"longDate"):"Unknown"," "),s(6),f(" ",S(17,22,e.percentageOfTotal,"1.0-1")," "),s(7),f(" ",V(24,25,e.totalDrops)," "),s(6),f(" ",S(30,27,e.averageDropsPerDay,"1.0-1")," "),s(6),f(" ",U(36,30,e.amount,"$ ","symbol","1.0-0")," "),s(6),f(" ",U(42,35,e.averageAmountPerDay,"$ ","symbol","1.0-0")," "),s(3),D("chartData",t.employeeTrendChartData())("chartOptions",t.employeeTrendChartOptions)("chartType",t.lineChartType),s(),D("chartData",t.employeeDropTypeChartData())("chartOptions",t.employeeDropTypeChartOptions)("chartType",t.pieChartType),s(),D("chartData",t.employeeShiftChartData())("chartOptions",t.employeeShiftChartOptions)("chartType",t.barChartType)}}function Ne(l,g){if(l&1&&(o(0,"app-card",32),v(1,Pe,47,40,"ng-container",33),i()),l&2){let e=h();s(),D("ngIf",e.selectedEmployee())}}function Ae(l,g){l&1&&(o(0,"div",48),u(1," Select an employee to view detailed performance charts. "),i())}var Se,ce,be=Y(()=>{"use strict";M();z();De();ye();he();xe();M();z();Se=(l,g)=>g.value;ce=(()=>{class l{avatarPalette=["#2563eb","#16a34a","#ea580c","#9333ea","#0ea5e9","#f97316","#dc2626","#14b8a6"];recordsSignal=b([]);tabledata=b([]);set records(e){this.recordsSignal.set(Array.isArray(e)?e:[]),this.tabledata.set(this.filteredTableData()||[])}performanceRange=b("month");customStart=b(null);customEnd=b(null);selectedEmployeeId=b(null);rangeOptions=[{label:"Today",value:"today"},{label:"This Week",value:"week"},{label:"This Month",value:"month"},{label:"This Year",value:"year"}];filteredRecords=y(()=>{let e=this.recordsSignal(),t=this.performanceRange(),a=this.customStart(),r=this.customEnd(),{startDate:p,endDate:n}=this.getRangeBounds(t,a,r);if(!p&&!n)return e;var m=e.filter(c=>{let C=this.parseRecordDate(c);return!(!C||p&&C<p||n&&C>n)});return m});employeeSummaries=y(()=>{let e=this.filteredRecords();if(!e.length)return[];let t=new Map;e.forEach(n=>{let m=n.FIN||n.NAME||`employee-${n.Timestamp}`,c=n.NAME?.trim()||"Unknown",C=this.getInitials(c),d=t.get(m)||{id:m,name:c,initials:C,totalDrops:0,hireDate:null,dailyTotals:new Map,dropTypes:{"Multi Drops":0,"Heavy Drops":0,"Walkup Drop Count":0,"Double Drop Count":0},shifts:new Set,amount:0,multiDrops:0,heavyDrops:0,walkupDrops:0,doubleDrops:0,records:[]},P=this.parseRecordDate(n);if(P){d.hireDate=this.getEarlierDate(d.hireDate,P);let j=this.formatDateKey(P),fe=d.dailyTotals.get(j)??0;d.dailyTotals.set(j,fe+this.ensureNumber(n["Total Drops"]))}d.totalDrops+=this.ensureNumber(n["Total Drops"]),d.amount+=this.ensureNumber(n.Amount),d.multiDrops+=this.ensureNumber(n["Multi Drops"]),d.heavyDrops+=this.ensureNumber(n["Heavy Drops"]),d.walkupDrops+=this.ensureNumber(n["Walkup Drop Count"]),d.doubleDrops+=this.ensureNumber(n["Double Drop Count"]),d.dropTypes["Multi Drops"]+=this.ensureNumber(n["Multi Drops"]),d.dropTypes["Heavy Drops"]+=this.ensureNumber(n["Heavy Drops"]),d.dropTypes["Walkup Drop Count"]+=this.ensureNumber(n["Walkup Drop Count"]),d.dropTypes["Double Drop Count"]+=this.ensureNumber(n["Double Drop Count"]),n.Shift&&d.shifts.add(n.Shift),d.records.push(n),t.set(m,d)});let a=Array.from(t.values()),r=a.reduce((n,m)=>n+m.totalDrops,0),p=a.length?r/a.length:0;return a.map((n,m)=>{let c=n.dailyTotals.size||1,C=n.totalDrops/c,d=n.amount/c,P=n.totalDrops>p?"up":n.totalDrops<p?"down":"flat";return{id:n.id,name:n.name,initials:n.initials,avatarColor:this.avatarPalette[m%this.avatarPalette.length],totalDrops:n.totalDrops,averageDropsPerDay:C,averageAmountPerDay:d,hireDate:n.hireDate,percentageOfTotal:r?n.totalDrops/r:0,trendDirection:P,dailyTotals:n.dailyTotals,dropTypes:n.dropTypes,shifts:Array.from(n.shifts),amount:n.amount,multiDrops:n.multiDrops,heavyDrops:n.heavyDrops,walkupDrops:n.walkupDrops,doubleDrops:n.doubleDrops,records:n.records}}).sort((n,m)=>m.totalDrops-n.totalDrops)});selectedEmployee=y(()=>{let e=this.selectedEmployeeId(),t=this.employeeSummaries();if(!t.length)return null;if(e){let a=t.find(r=>r.id===e);if(a)return a}return t[0]});employeeTrendChartData=y(()=>{let e=this.selectedEmployee();if(!e)return this.createLineChartData([],[],"Daily Drops",{background:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 1)"});let t=Array.from(e.dailyTotals.keys()).sort(),a=t.map(p=>this.formatDisplayDate(p)),r=t.map(p=>e.dailyTotals.get(p)??0);return this.createLineChartData(a,r,"Daily Drops",{background:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 1)"})});employeeTrendChartOptions={elements:{line:{tension:.4}},scales:{y:{beginAtZero:!0}},plugins:{legend:{display:!1}},responsive:!0,maintainAspectRatio:!1};employeeDropTypeChartData=y(()=>{let e=this.selectedEmployee();if(!e)return this.createPieChartData([],[]);let t=Object.entries(e.dropTypes).filter(([,a])=>this.ensureNumber(a)>0);return t.length?this.createPieChartData(t.map(([a])=>a),t.map(([,a])=>a),["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"]):this.createPieChartData([],[])});employeeDropTypeChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}};employeeShiftChartData=y(()=>{let e=this.selectedEmployee();if(!e)return this.createBarChartData([],[],"Drops by Shift");let t=this.groupAndSum(e.records,a=>a.Shift||"Unassigned","Total Drops");return this.createBarChartData(t.labels,t.values,"Drops by Shift",{background:"rgba(22, 163, 74, 0.8)",border:"rgba(22, 163, 74, 1)"})});employeeShiftChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}};isCustomRangeValid=y(()=>{let e=this.customStart(),t=this.customEnd();if(!e||!t)return!1;let a=new Date(e),r=new Date(t);return a.setHours(0,0,0,0),r.setHours(0,0,0,0),a<=r});lineChartType="line";pieChartType="pie";barChartType="bar";constructor(){I(()=>{let e=this.employeeSummaries(),t=this.selectedEmployeeId();if(!e.length){t!==null&&this.selectedEmployeeId.set(null);return}(t?e.some(r=>r.id===t):!1)||this.selectedEmployeeId.set(e[0].id)}),I(()=>{let e=this.groupedTableData();this.groupedTableDataSignal.set(e)}),I(()=>{let e=this.dropRecordsTableData();this.dropRecordsTableDataSignal.set(e)})}setRange(e){this.performanceRange.set(e),this.tabledata.set(this.filteredTableData()||[]),e!=="custom"&&(this.customStart.set(null),this.customEnd.set(null))}applyCustomRange(){this.isCustomRangeValid()&&this.performanceRange.set("custom")}updateCustomStart(e){this.customStart.set(e||null),this.customStart.set(e||null)}updateCustomEnd(e){this.customEnd.set(e||null)}selectEmployee(e){this.selectedEmployeeId.set(e),this.tabledata.set(this.filteredTableData()||[])}trackByEmployeeId(e,t){return t.id}getRangeBounds(e,t,a){let r=new Date,p=new Date(r.getFullYear(),r.getMonth(),r.getDate());switch(e){case"today":return{startDate:p,endDate:new Date(p.getTime()+24*60*60*1e3-1)};case"week":{let n=new Date(p);return n.setDate(n.getDate()-6),{startDate:n,endDate:r}}case"month":return{startDate:new Date(r.getFullYear(),r.getMonth(),1),endDate:r};case"year":return{startDate:new Date(r.getFullYear(),0,1),endDate:r};case"custom":{let n=t?new Date(new Date(t).setHours(0,0,0,0)):null,m=a?new Date(new Date(a).setHours(0,0,0,0)):null;return{startDate:n,endDate:m}}default:return{startDate:null,endDate:null}}}parseRecordDate(e){let t=e.DATE||e.Timestamp;if(!t)return null;let a=new Date(t);return Number.isNaN(a.getTime())?null:a}getInitials(e){let t=e.split(" ").filter(Boolean);return t.length===0?"?":t.length===1?t[0].slice(0,2).toUpperCase():(t[0][0]+t[t.length-1][0]).toUpperCase()}ensureNumber(e){if(typeof e=="number")return Number.isFinite(e)?e:0;let t=Number(e);return Number.isFinite(t)?t:0}getEarlierDate(e,t){return e?t<e?t:e:t}formatDateKey(e){return e.toISOString().split("T")[0]}formatDisplayDate(e){let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}createLineChartData(e,t,a,r){return{labels:e,datasets:[{data:t,label:a,backgroundColor:r.background,borderColor:r.border,pointBackgroundColor:r.border,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:r.border,fill:"origin"}]}}createBarChartData(e,t,a,r={background:"rgba(59, 130, 246, 0.8)",border:"rgba(59, 130, 246, 1)"}){return{labels:e,datasets:[{data:t,label:a,backgroundColor:r.background,borderColor:r.border,borderWidth:1}]}}createPieChartData(e,t,a=[]){return{labels:e,datasets:[{data:t,backgroundColor:a.length>0?a:["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)"],borderColor:"#fff",borderWidth:1}]}}groupAndSum(e,t,a){let r=new Map;e.forEach(m=>{let c=t(m)||"Unknown",C=r.get(c)??0,d=this.ensureNumber(m[a]);r.set(c,C+d)});let p=Array.from(r.keys()),n=p.map(m=>r.get(m)??0);return{labels:p,values:n}}getTrendIcon(e){switch(e){case"up":return"\u2191";case"down":return"\u2193";default:return"\u2192"}}getTrendClasses(e){switch(e){case"up":return"text-green-600";case"down":return"text-red-600";default:return"text-gray-500"}}recordsCount=y(()=>this.filteredRecords().length);tableColumns=[{key:"DATE",label:"Date",type:"text"},{key:"NAME",label:"Name",type:"text"},{key:"Shift",label:"Shift",type:"text"},{key:"Total Drops",label:"Total Drops",type:"number",numeric:!0},{key:"Multi Drops",label:"Multi Drops",type:"number",numeric:!0},{key:"Heavy Drops",label:"Heavy Drops",type:"number",numeric:!0},{key:"Walkup Drop Count",label:"Walkup Drops",type:"number",numeric:!0},{key:"Double Drop Count",label:"Double Drops",type:"number",numeric:!0},{key:"Amount",label:"Amount",type:"number",numeric:!0}];BydaytableColumns=[{key:"DATE",label:"Date",type:"text"},{key:"NAME",label:"Name",type:"text"},{key:"Total Drops",label:"Total Drops",type:"number",numeric:!0},{key:"Multi Drops",label:"Multi Drops",type:"number",numeric:!0},{key:"Heavy Drops",label:"Heavy Drops",type:"number",numeric:!0},{key:"Walkup Drop Count",label:"Walkup Drops",type:"number",numeric:!0},{key:"Double Drop Count",label:"Double Drops",type:"number",numeric:!0},{key:"Amount",label:"Amount",type:"number",numeric:!0}];tableFilters=b(this.tableColumns.reduce((e,t)=>(e[t.key]="",e),{}));sortState=b(null);filteredTableData=y(()=>this.selectedEmployee()?.records||[]);groupedTableData=y(()=>{let e=this.filteredTableData();if(!e.length)return[];let t=new Map;return e.forEach(r=>{let p=r.DATE||"Unknown",n=r.NAME||"Unknown",m=`${p}|${n}`,c=t.get(m);c?(c["Total Drops"]+=this.ensureNumber(r["Total Drops"]),c["Multi Drops"]+=this.ensureNumber(r["Multi Drops"]),c["Heavy Drops"]+=this.ensureNumber(r["Heavy Drops"]),c["Walkup Drop Count"]+=this.ensureNumber(r["Walkup Drop Count"]),c["Double Drop Count"]+=this.ensureNumber(r["Double Drop Count"]),c.Amount+=this.ensureNumber(r.Amount),c.DropCount+=this.ensureNumber(r.DropCount||0)):t.set(m,{DATE:p,NAME:n,"Total Drops":this.ensureNumber(r["Total Drops"]),"Multi Drops":this.ensureNumber(r["Multi Drops"]),"Heavy Drops":this.ensureNumber(r["Heavy Drops"]),"Walkup Drop Count":this.ensureNumber(r["Walkup Drop Count"]),"Double Drop Count":this.ensureNumber(r["Double Drop Count"]),Amount:this.ensureNumber(r.Amount),DropCount:this.ensureNumber(r.DropCount||0)})}),Array.from(t.values()).sort((r,p)=>{let n=this.parseRecordDate({DATE:r.DATE}),m=this.parseRecordDate({DATE:p.DATE});return!n&&!m?0:n?m?m.getTime()-n.getTime():-1:1})});groupedTableDataSignal=b([]);groupedTablePageSize=b(10);dropRecordsTableData=y(()=>{let e=this.filteredTableData();return e.length?[...e].sort((t,a)=>{let r=this.parseRecordDate(t),p=this.parseRecordDate(a);return!r&&!p?0:r?p?p.getTime()-r.getTime():-1:1}):[]});dropRecordsTableDataSignal=b([]);dropRecordsTablePageSize=b(10);dropRecordsTableColumns=[{key:"DATE",label:"Date",sortable:!0,filterable:!0},{key:"NAME",label:"Name",sortable:!0,filterable:!0},{key:"Shift",label:"Shift",sortable:!0,filterable:!0},{key:"Total Drops",label:"Total Drops",sortable:!0,render:e=>this.ensureNumber(e["Total Drops"]).toLocaleString()},{key:"Multi Drops",label:"Multi Drops",sortable:!0,render:e=>this.ensureNumber(e["Multi Drops"]).toLocaleString()},{key:"Heavy Drops",label:"Heavy Drops",sortable:!0,render:e=>this.ensureNumber(e["Heavy Drops"]).toLocaleString()},{key:"Walkup Drop Count",label:"Walkup Drops",sortable:!0,render:e=>this.ensureNumber(e["Walkup Drop Count"]).toLocaleString()},{key:"Double Drop Count",label:"Double Drops",sortable:!0,render:e=>this.ensureNumber(e["Double Drop Count"]).toLocaleString()},{key:"Amount",label:"Amount",sortable:!0,render:e=>new Intl.NumberFormat(void 0,{style:"currency",currency:"SGD",maximumFractionDigits:0}).format(this.ensureNumber(e.Amount))}];groupedTableColumns=[{key:"DATE",label:"Date",sortable:!0,filterable:!0},{key:"NAME",label:"Name",sortable:!0,filterable:!0},{key:"Total Drops",label:"Total Drops",sortable:!0,render:e=>e["Total Drops"].toLocaleString()},{key:"Multi Drops",label:"Multi Drops",sortable:!0,render:e=>e["Multi Drops"].toLocaleString()},{key:"Heavy Drops",label:"Heavy Drops",sortable:!0,render:e=>e["Heavy Drops"].toLocaleString()},{key:"Walkup Drop Count",label:"Walkup Drops",sortable:!0,render:e=>e["Walkup Drop Count"].toLocaleString()},{key:"Double Drop Count",label:"Double Drops",sortable:!0,render:e=>e["Double Drop Count"].toLocaleString()},{key:"Amount",label:"Amount",sortable:!0,render:e=>new Intl.NumberFormat(void 0,{style:"currency",currency:"SGD",maximumFractionDigits:0}).format(e.Amount)},{key:"DropCount",label:"Drop Count",sortable:!0,render:e=>e.DropCount.toLocaleString()}];updateFilter(e,t){this.tableFilters.update(a=>G($({},a),{[e]:t}))}clearFilters(){this.tableFilters.set(this.tableColumns.reduce((e,t)=>(e[t.key]="",e),{}))}toggleSort(e){this.sortState.update(t=>!t||t.key!==e?{key:e,direction:"asc"}:t.direction==="asc"?{key:e,direction:"desc"}:null)}getSortDirection(e){return this.sortState()?.key===e?this.sortState().direction:null}getFilterValue(e){return this.tableFilters()[e]??""}formatCellValue(e,t){let a=e[t.key];return a==null?"\u2014":t.key==="Amount"?new Intl.NumberFormat(void 0,{style:"currency",currency:"SGD",maximumFractionDigits:0}).format(this.ensureNumber(a)):t.key==="Timestamp"?this.formatTimestamp(String(a)):String(a)}trackByRecord=(e,t)=>t.Timestamp||t.FIN||e;formatTimestamp(e){if(!e)return"Unknown time";let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})}static \u0275fac=function(t){return new(t||l)};static \u0275cmp=N({type:l,selectors:[["app-performance-panel"]],inputs:{records:"records"},decls:26,vars:20,consts:[["noSelection",""],[1,"space-y-6"],[1,"flex","flex-col","gap-3","lg:flex-row","lg:items-center","lg:justify-between"],[1,"flex","flex-wrap","gap-2"],["type","button",1,"rounded-full","border","px-4","py-1.5","text-sm","font-medium","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"bg-primary-600","text-white","border-primary-600","border-gray-200","text-gray-600"],[1,"flex","flex-wrap","items-center","gap-2"],["type","date",1,"rounded-md","border","border-gray-300","px-3","py-1.5","text-sm","focus:border-primary-500","focus:outline-none","focus:ring-2","focus:ring-primary-200",3,"change","value"],[1,"text-sm","text-gray-400"],["type","button",1,"rounded-md","bg-primary-600","px-4","py-1.5","text-sm","font-medium","text-white","transition","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","disabled:bg-gray-300","disabled:text-gray-500",3,"click","disabled"],[1,"grid","grid-cols-1","gap-6","lg:grid-cols-[320px_minmax(0,1fr)]"],[1,"space-y-4"],[1,"rounded-lg","border","border-dashed","border-gray-300","bg-gray-50","p-6","text-center","text-sm","text-gray-500"],["title","Performance Overview","padding","sm",4,"ngIf","ngIfElse"],["title","Grouped Summary","subtitle","Grouped by Date and Name (excluding Shift)","padding","sm"],[3,"columns","data","pagination","pageSize","showToolbar","showFilters","searchable"],["title","Drop Records","subtitle","All records ordered by date (newest first)","padding","sm"],["type","button",1,"rounded-full","border","px-4","py-1.5","text-sm","font-medium","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"click"],["type","button",1,"w-full","rounded-xl","border","px-4","py-4","text-left","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"border-primary-500","bg-primary-50","border-gray-200"],["type","button",1,"w-full","rounded-xl","border","px-4","py-4","text-left","transition","focus:outline-none","focus:ring-2","focus:ring-primary-500",3,"click"],[1,"flex","items-start","gap-4"],[1,"flex","h-12","w-12","items-center","justify-center","rounded-full","text-lg","font-semibold","text-white"],[1,"flex-1","space-y-2"],[1,"flex","items-center","justify-between","gap-2"],[1,"text-sm","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"text-right"],[1,"text-xs","text-gray-400"],[1,"text-sm","font-semibold","text-gray-900"],[1,"flex","items-center","justify-between","gap-2","text-xs"],[1,"text-gray-500"],[1,"font-medium","text-gray-900"],[1,"flex","items-center","gap-1"],["title","Performance Overview","padding","sm"],[4,"ngIf"],[1,"flex","flex-col","gap-4"],[1,"flex","flex-wrap","items-center","justify-between","gap-3"],[1,"flex","items-center","gap-3"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-500"],[1,"text-base","font-medium","text-gray-900"],[1,"grid","grid-cols-2","gap-4","md:grid-cols-4"],[1,"rounded-lg","border","border-gray-200","bg-gray-50","p-3"],[1,"text-xs","uppercase","text-gray-400"],[1,"mt-1","text-lg","font-semibold","text-gray-900"],[1,"grid","grid-cols-1","gap-4","lg:grid-cols-2"],["title","Daily Drops Trend","subtitle","Drops completed per day","height","240px",3,"chartData","chartOptions","chartType"],["title","Drop Distribution","subtitle","Mix of drop types","height","240px",3,"chartData","chartOptions","chartType"],["title","Drops by Shift","subtitle","Shift allocation for this team member","height","240px",3,"chartData","chartOptions","chartType"],[1,"rounded-lg","border","border-dashed","border-gray-300","bg-gray-50","p-8","text-center","text-sm","text-gray-500"]],template:function(t,a){if(t&1){let r=A();o(0,"div",1)(1,"div",2)(2,"div",3),L(3,ke,2,11,"button",4,Se),i(),o(5,"div",5)(6,"input",6),w("change",function(n){return k(r),E(a.updateCustomStart((n.target==null?null:n.target.value)||""))}),i(),o(7,"span",7),u(8,"to"),i(),o(9,"input",6),w("change",function(n){return k(r),E(a.updateCustomEnd((n.target==null?null:n.target.value)||""))}),i(),o(10,"button",8),w("click",function(){return k(r),E(a.applyCustomRange())}),u(11," Apply "),i()()(),o(12,"div",9)(13,"div",10),v(14,Ee,2,0,"div",11)(15,we,2,0),i(),o(16,"div",10),v(17,Ne,2,1,"app-card",12),o(18,"section")(19,"app-card",13),T(20,"app-data-table",14),i()(),o(21,"section")(22,"app-card",15),T(23,"app-data-table",14),i()(),v(24,Ae,2,0,"ng-template",null,0,te),i()()()}if(t&2){let r=ee(25);s(3),O(a.rangeOptions),s(3),D("value",a.customStart()||""),s(3),D("value",a.customEnd()||""),s(),D("disabled",!a.isCustomRangeValid()),s(4),_(a.employeeSummaries().length===0?14:15),s(3),D("ngIf",a.selectedEmployee())("ngIfElse",r),s(3),D("columns",a.groupedTableColumns)("data",a.groupedTableDataSignal)("pagination",!0)("pageSize",a.groupedTablePageSize)("showToolbar",!1)("showFilters",!0)("searchable",!1),s(3),D("columns",a.dropRecordsTableColumns)("data",a.dropRecordsTableDataSignal)("pagination",!0)("pageSize",a.dropRecordsTablePageSize)("showToolbar",!1)("showFilters",!0)("searchable",!1)}},dependencies:[R,re,ne,oe,ie,ae,le,se,pe,ue],encapsulation:2})}return l})()});function Ie(l,g){l&1&&(o(0,"div",3),u(1," Loading performance data\u2026 "),i())}function Me(l,g){if(l&1&&(o(0,"div",4),u(1),i()),l&2){let e=h();s(),f(" ",e.error()," ")}}function Re(l,g){if(l&1&&T(0,"app-performance-panel",5),l&2){let e=h();D("records",e.performanceData())}}var et,Fe=Y(()=>{M();z();Ce();ge();ve();be();M();et=(()=>{class l{dashboardService=F(de);destroyRef=F(q);isLoading=b(!1);error=b(null);performanceData=b([]);ngOnInit(){this.loadPerformanceData()}loadPerformanceData(){this.isLoading.set(!0),this.error.set(null),this.dashboardService.getDashboardData().pipe(me(this.destroyRef),Z(()=>this.isLoading.set(!1))).subscribe({next:e=>{console.log("Performance Data Loaded:",e),this.performanceData.set(e)},error:e=>{this.error.set(this.extractErrorMessage(e)),this.performanceData.set([])}})}extractErrorMessage(e){return e instanceof Error||e&&typeof e=="object"&&"message"in e&&typeof e.message=="string"?e.message:"Unable to load performance data. Please try again later."}static \u0275fac=function(t){return new(t||l)};static \u0275cmp=N({type:l,selectors:[["app-performance"]],decls:9,vars:3,consts:[[1,"space-y-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"],[1,"rounded-md","border","border-primary-200","bg-primary-50","px-4","py-3","text-sm","text-primary-800"],[1,"rounded-md","border","border-red-200","bg-red-50","px-4","py-3","text-sm","text-red-700"],[3,"records"]],template:function(t,a){t&1&&(o(0,"div",0)(1,"div")(2,"h1",1),u(3,"Performance"),i(),o(4,"p",2),u(5," Monitor employee drops, trends, and shift mix with interactive filters. "),i()(),v(6,Ie,2,0,"div",3)(7,Me,2,1,"div",4)(8,Re,1,1,"app-performance-panel",5),i()),t&2&&(s(6),_(a.isLoading()?6:-1),s(),_(a.error()?7:-1),s(),_(!a.isLoading()&&!a.error()?8:-1))},dependencies:[R,ce],encapsulation:2})}return l})()});Fe();export{et as PerformanceComponent};
